<!DOCTYPE html>
<html lang="zh-CN" dir="ltr">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>React åŸç† | å‰ç«¯é¢è¯•æ´¾</title>
    <meta name="description" content="ç³»ç»Ÿä¸“ä¸šçš„å‰ç«¯é¢è¯•å¯¼èˆªï¼Œå¤§å‚é¢è¯•è§„èŒƒï¼Œå¼€æºå…è´¹">
    <meta name="generator" content="VitePress v1.5.0">
    <link rel="preload stylesheet" href="/mianshi/assets/style.Dwb_TB2c.css" as="style">
    <link rel="preload stylesheet" href="/mianshi/vp-icons.css" as="style">
    
    <script type="module" src="/mianshi/assets/app.B6y3aIlz.js"></script>
    <link rel="preload" href="/mianshi/assets/inter-roman-latin.Di8DUHzh.woff2" as="font" type="font/woff2" crossorigin="">
    <link rel="modulepreload" href="/mianshi/assets/chunks/theme.DZt-l4XS.js">
    <link rel="modulepreload" href="/mianshi/assets/chunks/framework.CDk703ml.js">
    <link rel="modulepreload" href="/mianshi/assets/docs_second-exam_react-inner.md.DMnU0yeD.lean.js">
    <link rel="icon" href="/favicon.ico">
    <meta name="author" content="åŒè¶Šè€å¸ˆ">
    <meta name="keywords" content="å‰ç«¯, é¢è¯•, å‰ç«¯é¢è¯•, é¢è¯•é¢˜, åˆ·é¢˜, é¢è¯•æµç¨‹, å‰ç«¯é¢è¯•æµç¨‹, é¢è¯•å‡†å¤‡, ç®€å†, å‰ç«¯ç®€å†, å¼€æº, å…è´¹, Javascript, Typescript, React, Vue, webpack, vite, HTTP, ç®—æ³•">
    <script>var _hmt=_hmt||[];(function(){if(!(location.hostname.indexOf("mianshipai.com")<0)){var e=document.createElement("script");e.src="https://hm.baidu.com/hm.js?b53b3c926f6f6f5be6a9ac7e0911622b";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)}})();</script>
    <script>setTimeout(function(){},2e3);</script>
    <script>setTimeout(function(){const o=document.querySelector("header");if(o==null)return;o.style.top="25px";const e=document.createElement("div");e.style.backgroundColor="oklch(97.3% .071 103.193)",e.style.color="#333",e.style.height="25px",e.style.position="fixed",e.style.top="0",e.style.left="0",e.style.width="100%",e.style.zIndex="9999",e.style.lineHeight="25px",e.style.fontSize="13px";const n=document.createElement("div");n.innerHTML="\u524D\u7AEF\u5B66 Node \u5168\u6808\u548C AI \u5F00\u53D1\uFF0C\u53EF\u52A0\u5165\u3010\u5212\u6C34AI\u3011\u9879\u76EE\u7814\u53D1\u5C0F\u7EC4\u3002\u53CC\u8D8A\u8001\u5E08\u5F00\u53D1\uFF0C\u590D\u6742\u9879\u76EE\uFF0C\u771F\u5B9E\u4E0A\u7EBF\uFF0C\u6301\u7EED\u7EF4\u62A4\u5347\u7EA7\u3002\u5728\u6B64\u8FDB\u5165\u6709\u4F18\u60E0 &gt;&gt;",n.style.width="80%",n.style.textAlign="center",n.style.margin="0 auto",n.style.cursor="pointer",n.addEventListener("click",function(){window.open("https://www.huashuiai.com/join?from=\u524D\u7AEF\u9762\u8BD5\u6D3E","_blank")});const t=document.createElement("div");t.innerHTML="x",t.style.width="16px",t.style.textAlign="center",t.style.position="absolute",t.style.right="8px",t.style.top="0",t.style.cursor="pointer",t.addEventListener("click",function(l){l.stopPropagation(),e.parentNode.removeChild(e),o.style.top="0"}),e.appendChild(n),e.appendChild(t),o.parentNode.insertBefore(e,o)},1e3);</script>
    <script id="check-dark-mode">(()=>{const e=localStorage.getItem("vitepress-theme-appearance")||"auto",a=window.matchMedia("(prefers-color-scheme: dark)").matches;(!e||e==="auto"?a:e==="dark")&&document.documentElement.classList.add("dark")})();</script>
    <script id="check-mac-os">document.documentElement.classList.toggle("mac",/Mac|iPhone|iPod|iPad/i.test(navigator.platform));</script>
  </head>
  <body>
    <div id="app"><div class="Layout" data-v-d8b57b2d><!--[--><!--]--><!--[--><span tabindex="-1" data-v-c8291ffa></span><a href="#VPContent" class="VPSkipLink visually-hidden" data-v-c8291ffa> Skip to content </a><!--]--><!----><header class="VPNav" data-v-d8b57b2d data-v-7ad780c2><div class="VPNavBar" data-v-7ad780c2 data-v-9fd4d1dd><div class="wrapper" data-v-9fd4d1dd><div class="container" data-v-9fd4d1dd><div class="title" data-v-9fd4d1dd><div class="VPNavBarTitle has-sidebar" data-v-9fd4d1dd data-v-9f43907a><a class="title" href="/mianshi/" data-v-9f43907a><!--[--><!--]--><!----><span data-v-9f43907a>å‰ç«¯é¢è¯•æ´¾</span><!--[--><!--]--></a></div></div><div class="content" data-v-9fd4d1dd><div class="content-body" data-v-9fd4d1dd><!--[--><!--]--><div class="VPNavBarSearch search" data-v-9fd4d1dd><!--[--><!----><div id="local-search"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><span class="vp-icon DocSearch-Search-Icon"></span><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"><kbd class="DocSearch-Button-Key"></kbd><kbd class="DocSearch-Button-Key">K</kbd></span></button></div><!--]--></div><nav aria-labelledby="main-nav-aria-label" class="VPNavBarMenu menu" data-v-9fd4d1dd data-v-afb2845e><span id="main-nav-aria-label" class="visually-hidden" data-v-afb2845e> Main Navigation </span><!--[--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/mianshi/docs/services/1v1.html" tabindex="0" data-v-afb2845e data-v-815115f5><!--[--><span data-v-815115f5>1v1 é¢è¯•å’¨è¯¢ ğŸ”¥</span><!--]--></a><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/mianshi/docs/services/group.html" tabindex="0" data-v-afb2845e data-v-815115f5><!--[--><span data-v-815115f5>åŠ ç¾¤è®¨è®ºç­”ç–‘</span><!--]--></a><!--]--><!--[--><a class="VPLink link vp-external-link-icon VPNavBarMenuLink" href="https://github.com/mianshipai/mianshipai-web#%E8%B4%A1%E7%8C%AE%E9%A2%98%E7%9B%AE%E5%92%8C%E7%AD%94%E6%A1%88" target="_blank" rel="noreferrer" tabindex="0" data-v-afb2845e data-v-815115f5><!--[--><span data-v-815115f5>æˆä¸ºè´¡çŒ®è€…</span><!--]--></a><!--]--><!--]--></nav><!----><div class="VPNavBarAppearance appearance" data-v-9fd4d1dd data-v-3f90c1a5><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" title aria-checked="false" data-v-3f90c1a5 data-v-be9742d9 data-v-b4ccac88><span class="check" data-v-b4ccac88><span class="icon" data-v-b4ccac88><!--[--><span class="vpi-sun sun" data-v-be9742d9></span><span class="vpi-moon moon" data-v-be9742d9></span><!--]--></span></span></button></div><div class="VPSocialLinks VPNavBarSocialLinks social-links" data-v-9fd4d1dd data-v-ef6192dc data-v-e71e869c><!--[--><a class="VPSocialLink no-icon" href="https://github.com/mianshipai/mianshipai-web" aria-label="github" target="_blank" rel="noopener" data-v-e71e869c data-v-60a9a2d3><span class="vpi-social-github"></span></a><!--]--></div><div class="VPFlyout VPNavBarExtra extra" data-v-9fd4d1dd data-v-f953d92f data-v-bfe7971f><button type="button" class="button" aria-haspopup="true" aria-expanded="false" aria-label="extra navigation" data-v-bfe7971f><span class="vpi-more-horizontal icon" data-v-bfe7971f></span></button><div class="menu" data-v-bfe7971f><div class="VPMenu" data-v-bfe7971f data-v-20ed86d6><!----><!--[--><!--[--><!----><div class="group" data-v-f953d92f><div class="item appearance" data-v-f953d92f><p class="label" data-v-f953d92f>Appearance</p><div class="appearance-action" data-v-f953d92f><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" title aria-checked="false" data-v-f953d92f data-v-be9742d9 data-v-b4ccac88><span class="check" data-v-b4ccac88><span class="icon" data-v-b4ccac88><!--[--><span class="vpi-sun sun" data-v-be9742d9></span><span class="vpi-moon moon" data-v-be9742d9></span><!--]--></span></span></button></div></div></div><div class="group" data-v-f953d92f><div class="item social-links" data-v-f953d92f><div class="VPSocialLinks social-links-list" data-v-f953d92f data-v-e71e869c><!--[--><a class="VPSocialLink no-icon" href="https://github.com/mianshipai/mianshipai-web" aria-label="github" target="_blank" rel="noopener" data-v-e71e869c data-v-60a9a2d3><span class="vpi-social-github"></span></a><!--]--></div></div></div><!--]--><!--]--></div></div></div><!--[--><!--]--><button type="button" class="VPNavBarHamburger hamburger" aria-label="mobile navigation" aria-expanded="false" aria-controls="VPNavScreen" data-v-9fd4d1dd data-v-6bee1efd><span class="container" data-v-6bee1efd><span class="top" data-v-6bee1efd></span><span class="middle" data-v-6bee1efd></span><span class="bottom" data-v-6bee1efd></span></span></button></div></div></div></div><div class="divider" data-v-9fd4d1dd><div class="divider-line" data-v-9fd4d1dd></div></div></div><!----></header><div class="VPLocalNav has-sidebar empty" data-v-d8b57b2d data-v-2488c25a><div class="container" data-v-2488c25a><button class="menu" aria-expanded="false" aria-controls="VPSidebarNav" data-v-2488c25a><span class="vpi-align-left menu-icon" data-v-2488c25a></span><span class="menu-text" data-v-2488c25a>Menu</span></button><div class="VPLocalNavOutlineDropdown" style="--vp-vh:0px;" data-v-2488c25a data-v-883964e0><button data-v-883964e0>Return to top</button><!----></div></div></div><aside class="VPSidebar" data-v-d8b57b2d data-v-42c4c606><div class="curtain" data-v-42c4c606></div><nav class="nav" id="VPSidebarNav" aria-labelledby="sidebar-aria-label" tabindex="-1" data-v-42c4c606><span class="visually-hidden" id="sidebar-aria-label" data-v-42c4c606> Sidebar Navigation </span><!--[--><!--]--><!--[--><div class="no-transition group" data-v-51288d80><section class="VPSidebarItem level-0" data-v-51288d80 data-v-edd2eed8><div class="item" role="button" tabindex="0" data-v-edd2eed8><div class="indicator" data-v-edd2eed8></div><h2 class="text" data-v-edd2eed8>é¢è¯•å‡†å¤‡</h2><!----></div><div class="items" data-v-edd2eed8><!--[--><div class="VPSidebarItem level-1 is-link" data-v-edd2eed8 data-v-edd2eed8><div class="item" data-v-edd2eed8><div class="indicator" data-v-edd2eed8></div><a class="VPLink link link" href="/mianshi/docs/before-interview/process.html" data-v-edd2eed8><!--[--><p class="text" data-v-edd2eed8>äº†è§£é¢è¯•æµç¨‹</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-edd2eed8 data-v-edd2eed8><div class="item" data-v-edd2eed8><div class="indicator" data-v-edd2eed8></div><a class="VPLink link link" href="/mianshi/docs/before-interview/jd.html" data-v-edd2eed8><!--[--><p class="text" data-v-edd2eed8>åˆ†æ JD æ‹›è˜è¦æ±‚</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-edd2eed8 data-v-edd2eed8><div class="item" data-v-edd2eed8><div class="indicator" data-v-edd2eed8></div><a class="VPLink link link" href="/mianshi/docs/before-interview/write-resume.html" data-v-edd2eed8><!--[--><p class="text" data-v-edd2eed8>æ­£ç¡®å†™ç®€å†</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-edd2eed8 data-v-edd2eed8><div class="item" data-v-edd2eed8><div class="indicator" data-v-edd2eed8></div><a class="VPLink link link" href="/mianshi/docs/before-interview/post-resume.html" data-v-edd2eed8><!--[--><p class="text" data-v-edd2eed8>å¦‚ä½•æŠ•é€’ç®€å†</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><div class="no-transition group" data-v-51288d80><section class="VPSidebarItem level-0" data-v-51288d80 data-v-edd2eed8><div class="item" role="button" tabindex="0" data-v-edd2eed8><div class="indicator" data-v-edd2eed8></div><h2 class="text" data-v-edd2eed8>ç¬”è¯•</h2><!----></div><div class="items" data-v-edd2eed8><!--[--><div class="VPSidebarItem level-1 is-link" data-v-edd2eed8 data-v-edd2eed8><div class="item" data-v-edd2eed8><div class="indicator" data-v-edd2eed8></div><a class="VPLink link link" href="/mianshi/docs/written-exam/algorithm.html" data-v-edd2eed8><!--[--><p class="text" data-v-edd2eed8>æ•°æ®ç»“æ„å’Œç®—æ³•</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-edd2eed8 data-v-edd2eed8><div class="item" data-v-edd2eed8><div class="indicator" data-v-edd2eed8></div><a class="VPLink link link" href="/mianshi/docs/written-exam/JS-writing.html" data-v-edd2eed8><!--[--><p class="text" data-v-edd2eed8>JS æ‰‹å†™ä»£ç </p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-edd2eed8 data-v-edd2eed8><div class="item" data-v-edd2eed8><div class="indicator" data-v-edd2eed8></div><a class="VPLink link link" href="/mianshi/docs/written-exam/JS-reading.html" data-v-edd2eed8><!--[--><p class="text" data-v-edd2eed8>JS è¯»ä»£ç </p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><div class="no-transition group" data-v-51288d80><section class="VPSidebarItem level-0" data-v-51288d80 data-v-edd2eed8><div class="item" role="button" tabindex="0" data-v-edd2eed8><div class="indicator" data-v-edd2eed8></div><h2 class="text" data-v-edd2eed8>ä¸€é¢</h2><!----></div><div class="items" data-v-edd2eed8><!--[--><div class="VPSidebarItem level-1 is-link" data-v-edd2eed8 data-v-edd2eed8><div class="item" data-v-edd2eed8><div class="indicator" data-v-edd2eed8></div><a class="VPLink link link" href="/mianshi/docs/first-exam/ComputerBase.html" data-v-edd2eed8><!--[--><p class="text" data-v-edd2eed8>è®¡ç®—æœºåŸºç¡€</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-edd2eed8 data-v-edd2eed8><div class="item" data-v-edd2eed8><div class="indicator" data-v-edd2eed8></div><a class="VPLink link link" href="/mianshi/docs/first-exam/HTML-CSS.html" data-v-edd2eed8><!--[--><p class="text" data-v-edd2eed8>HTML å’Œ CSS</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-edd2eed8 data-v-edd2eed8><div class="item" data-v-edd2eed8><div class="indicator" data-v-edd2eed8></div><a class="VPLink link link" href="/mianshi/docs/first-exam/JS.html" data-v-edd2eed8><!--[--><p class="text" data-v-edd2eed8>JS åŸºç¡€çŸ¥è¯†</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-edd2eed8 data-v-edd2eed8><div class="item" data-v-edd2eed8><div class="indicator" data-v-edd2eed8></div><a class="VPLink link link" href="/mianshi/docs/first-exam/TS.html" data-v-edd2eed8><!--[--><p class="text" data-v-edd2eed8>TS ç±»å‹</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-edd2eed8 data-v-edd2eed8><div class="item" data-v-edd2eed8><div class="indicator" data-v-edd2eed8></div><a class="VPLink link link" href="/mianshi/docs/first-exam/HTTP.html" data-v-edd2eed8><!--[--><p class="text" data-v-edd2eed8>HTTP ç½‘ç»œè¯·æ±‚</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><div class="no-transition group" data-v-51288d80><section class="VPSidebarItem level-0 has-active" data-v-51288d80 data-v-edd2eed8><div class="item" role="button" tabindex="0" data-v-edd2eed8><div class="indicator" data-v-edd2eed8></div><h2 class="text" data-v-edd2eed8>äºŒé¢</h2><!----></div><div class="items" data-v-edd2eed8><!--[--><div class="VPSidebarItem level-1 is-link" data-v-edd2eed8 data-v-edd2eed8><div class="item" data-v-edd2eed8><div class="indicator" data-v-edd2eed8></div><a class="VPLink link link" href="/mianshi/docs/second-exam/vue-usage.html" data-v-edd2eed8><!--[--><p class="text" data-v-edd2eed8>Vue ä½¿ç”¨</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-edd2eed8 data-v-edd2eed8><div class="item" data-v-edd2eed8><div class="indicator" data-v-edd2eed8></div><a class="VPLink link link" href="/mianshi/docs/second-exam/vue-inner.html" data-v-edd2eed8><!--[--><p class="text" data-v-edd2eed8>Vue åŸç†</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-edd2eed8 data-v-edd2eed8><div class="item" data-v-edd2eed8><div class="indicator" data-v-edd2eed8></div><a class="VPLink link link" href="/mianshi/docs/second-exam/react-usage.html" data-v-edd2eed8><!--[--><p class="text" data-v-edd2eed8>React ä½¿ç”¨</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-edd2eed8 data-v-edd2eed8><div class="item" data-v-edd2eed8><div class="indicator" data-v-edd2eed8></div><a class="VPLink link link" href="/mianshi/docs/second-exam/react-inner.html" data-v-edd2eed8><!--[--><p class="text" data-v-edd2eed8>React åŸç†</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-edd2eed8 data-v-edd2eed8><div class="item" data-v-edd2eed8><div class="indicator" data-v-edd2eed8></div><a class="VPLink link link" href="/mianshi/docs/second-exam/mini-program.html" data-v-edd2eed8><!--[--><p class="text" data-v-edd2eed8>å°ç¨‹åº</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-edd2eed8 data-v-edd2eed8><div class="item" data-v-edd2eed8><div class="indicator" data-v-edd2eed8></div><a class="VPLink link link" href="/mianshi/docs/second-exam/engineering.html" data-v-edd2eed8><!--[--><p class="text" data-v-edd2eed8>å‰ç«¯å·¥ç¨‹åŒ–</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-edd2eed8 data-v-edd2eed8><div class="item" data-v-edd2eed8><div class="indicator" data-v-edd2eed8></div><a class="VPLink link link" href="/mianshi/docs/second-exam/HarmonyOS-application-development.html" data-v-edd2eed8><!--[--><p class="text" data-v-edd2eed8>é¸¿è’™åº”ç”¨å¼€å‘</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-edd2eed8 data-v-edd2eed8><div class="item" data-v-edd2eed8><div class="indicator" data-v-edd2eed8></div><a class="VPLink link link" href="/mianshi/docs/second-exam/nodejs.html" data-v-edd2eed8><!--[--><p class="text" data-v-edd2eed8>Nodejs</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><div class="no-transition group" data-v-51288d80><section class="VPSidebarItem level-0" data-v-51288d80 data-v-edd2eed8><div class="item" role="button" tabindex="0" data-v-edd2eed8><div class="indicator" data-v-edd2eed8></div><h2 class="text" data-v-edd2eed8>ä¸‰é¢</h2><!----></div><div class="items" data-v-edd2eed8><!--[--><div class="VPSidebarItem level-1 is-link" data-v-edd2eed8 data-v-edd2eed8><div class="item" data-v-edd2eed8><div class="indicator" data-v-edd2eed8></div><a class="VPLink link link" href="/mianshi/docs/third-exam/cross-test.html" data-v-edd2eed8><!--[--><p class="text" data-v-edd2eed8>äº¤å‰é¢è¯•</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-edd2eed8 data-v-edd2eed8><div class="item" data-v-edd2eed8><div class="indicator" data-v-edd2eed8></div><a class="VPLink link link" href="/mianshi/docs/third-exam/project.html" data-v-edd2eed8><!--[--><p class="text" data-v-edd2eed8>é¡¹ç›®éš¾ç‚¹/æˆç»©</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-edd2eed8 data-v-edd2eed8><div class="item" data-v-edd2eed8><div class="indicator" data-v-edd2eed8></div><a class="VPLink link link" href="/mianshi/docs/third-exam/leader-test.html" data-v-edd2eed8><!--[--><p class="text" data-v-edd2eed8>å‰ç«¯ Leader é¢è¯•</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-edd2eed8 data-v-edd2eed8><div class="item" data-v-edd2eed8><div class="indicator" data-v-edd2eed8></div><a class="VPLink link link" href="/mianshi/docs/third-exam/ask-in-reply.html" data-v-edd2eed8><!--[--><p class="text" data-v-edd2eed8>åé—®é¢è¯•å®˜</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><div class="no-transition group" data-v-51288d80><section class="VPSidebarItem level-0" data-v-51288d80 data-v-edd2eed8><div class="item" role="button" tabindex="0" data-v-edd2eed8><div class="indicator" data-v-edd2eed8></div><h2 class="text" data-v-edd2eed8>HR é¢</h2><!----></div><div class="items" data-v-edd2eed8><!--[--><div class="VPSidebarItem level-1 is-link" data-v-edd2eed8 data-v-edd2eed8><div class="item" data-v-edd2eed8><div class="indicator" data-v-edd2eed8></div><a class="VPLink link link" href="/mianshi/docs/hr-exam/behavioural-test.html" data-v-edd2eed8><!--[--><p class="text" data-v-edd2eed8>è¡Œä¸ºé¢è¯•</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-edd2eed8 data-v-edd2eed8><div class="item" data-v-edd2eed8><div class="indicator" data-v-edd2eed8></div><a class="VPLink link link" href="/mianshi/docs/hr-exam/salary.html" data-v-edd2eed8><!--[--><p class="text" data-v-edd2eed8>è°ˆè–ªæŠ€å·§</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><div class="no-transition group" data-v-51288d80><section class="VPSidebarItem level-0" data-v-51288d80 data-v-edd2eed8><div class="item" role="button" tabindex="0" data-v-edd2eed8><div class="indicator" data-v-edd2eed8></div><h2 class="text" data-v-edd2eed8>æœåŠ¡</h2><!----></div><div class="items" data-v-edd2eed8><!--[--><div class="VPSidebarItem level-1 is-link" data-v-edd2eed8 data-v-edd2eed8><div class="item" data-v-edd2eed8><div class="indicator" data-v-edd2eed8></div><a class="VPLink link link" href="/mianshi/docs/services/group.html" data-v-edd2eed8><!--[--><p class="text" data-v-edd2eed8>åŠ ç¾¤è®¨è®ºç­”ç–‘</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-edd2eed8 data-v-edd2eed8><div class="item" data-v-edd2eed8><div class="indicator" data-v-edd2eed8></div><a class="VPLink link vp-external-link-icon link" href="https://github.com/mianshipai/mianshipai-web#%E8%B4%A1%E7%8C%AE%E9%A2%98%E7%9B%AE%E5%92%8C%E7%AD%94%E6%A1%88" target="_blank" rel="noreferrer" data-v-edd2eed8><!--[--><p class="text" data-v-edd2eed8>æˆä¸ºè´¡çŒ®è€…</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-edd2eed8 data-v-edd2eed8><div class="item" data-v-edd2eed8><div class="indicator" data-v-edd2eed8></div><a class="VPLink link link" href="/mianshi/docs/services/1v1.html" data-v-edd2eed8><!--[--><p class="text" data-v-edd2eed8>1v1 é¢è¯•å’¨è¯¢ ğŸ”¥</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><!--]--><!--[--><!--]--></nav></aside><div class="VPContent has-sidebar" id="VPContent" data-v-d8b57b2d data-v-9a6c75ad><div class="VPDoc has-sidebar has-aside" data-v-9a6c75ad data-v-e6f2a212><!--[--><!--]--><div class="container" data-v-e6f2a212><div class="aside" data-v-e6f2a212><div class="aside-curtain" data-v-e6f2a212></div><div class="aside-container" data-v-e6f2a212><div class="aside-content" data-v-e6f2a212><div class="VPDocAside" data-v-e6f2a212 data-v-cb998dce><!--[--><!--]--><!--[--><!--]--><nav aria-labelledby="doc-outline-aria-label" class="VPDocAsideOutline" data-v-cb998dce data-v-f610f197><div class="content" data-v-f610f197><div class="outline-marker" data-v-f610f197></div><div aria-level="2" class="outline-title" id="doc-outline-aria-label" role="heading" data-v-f610f197>ç›®å½•</div><ul class="VPDocOutlineItem root" data-v-f610f197 data-v-53c99d69><!--[--><!--]--></ul></div></nav><!--[--><!--]--><div class="spacer" data-v-cb998dce></div><!--[--><!--]--><!----><!--[--><!--]--><!--[--><!--]--></div></div></div></div><div class="content" data-v-e6f2a212><div class="content-container" data-v-e6f2a212><!--[--><!--]--><main class="main" data-v-e6f2a212><div style="position:relative;" class="vp-doc _mianshi_docs_second-exam_react-inner" data-v-e6f2a212><div><h1 id="react-åŸç†" tabindex="-1">React åŸç† <a class="header-anchor" href="#react-åŸç†" aria-label="Permalink to &quot;React åŸç†&quot;">â€‹</a></h1><p>å›½å†…é¢è¯•ï¼Œå¤§å‚å¿…è€ƒåŸç†ã€‚</p><div class="tip custom-block"><p class="custom-block-title">TIP</p><ol><li>ç›®æ ‡<strong>ä¸åœ¨</strong>ä¸­å¤§å‚çš„åŒå­¦ï¼Œå¯ä»¥ç•¥è¿‡è¿™ä¸€èŠ‚ã€‚</li><li>å¯¹ React ä½¿ç”¨å°šä¸ç†Ÿç»ƒçš„åŒå­¦ï¼Œä¸è¦åœ¨æ­¤èŠ±è´¹å¤ªå¤šç²¾åŠ›ï¼Œå…ˆç†Ÿæ‚‰ä½¿ç”¨å†è¯´ã€‚</li></ol></div><div class="tip custom-block"><p class="custom-block-title">TIP</p><p>å¦‚æœ‰ç–‘é—®ï¼Œå¯å…è´¹ <a href="/mianshi/docs/services/group.html">åŠ ç¾¤</a> è®¨è®ºå’¨è¯¢ï¼Œä¹Ÿå¯å‚ä¸ <a href="/mianshi/docs/services/1v1.html">1v1 é¢è¯•å’¨è¯¢æœåŠ¡</a>ï¼Œ ä¸“ä¸šã€ç³»ç»Ÿã€é«˜æ•ˆã€å…¨æµç¨‹ å‡†å¤‡å‰ç«¯é¢è¯•</p></div><h2 id="jsx-çš„æœ¬è´¨æ˜¯ä»€ä¹ˆ" tabindex="-1">JSX çš„æœ¬è´¨æ˜¯ä»€ä¹ˆï¼Ÿ <a class="header-anchor" href="#jsx-çš„æœ¬è´¨æ˜¯ä»€ä¹ˆ" aria-label="Permalink to &quot;JSX çš„æœ¬è´¨æ˜¯ä»€ä¹ˆï¼Ÿ&quot;">â€‹</a></h2><p>å‚è€ƒç­”æ¡ˆ</p><details class="details custom-block"><summary>Details</summary><p><strong>JSXï¼ˆJavaScript XMLï¼‰</strong> æ˜¯ä¸€ä¸ª JavaScript çš„è¯­æ³•æ‰©å±•ï¼Œå…è®¸åœ¨ JavaScript ä»£ç ä¸­é€šè¿‡ç±» HTML è¯­æ³•åˆ›å»º React å…ƒç´ ã€‚å®ƒéœ€è¦é€šè¿‡ Babel ç­‰å·¥å…·ç¼–è¯‘ä¸ºæ ‡å‡†çš„ JavaScript ä»£ç ï¼Œæœ€ç»ˆç”Ÿæˆ <strong>React å…ƒç´ å¯¹è±¡</strong>ï¼ˆReact Elementï¼‰ï¼Œè¿™äº›å…ƒç´ å…±åŒæ„æˆè™šæ‹Ÿ DOMï¼ˆVirtual DOMï¼‰æ ‘ã€‚</p><p><strong>æ ¸å¿ƒåŸç†</strong></p><ol><li><p><strong>JSX ç¼–è¯‘ä¸º React å…ƒç´ </strong> JSX ä¼šè¢«è½¬æ¢ä¸º <code>React.createElement()</code> è°ƒç”¨ï¼ˆæˆ– React 17+ çš„ <code>_jsx</code> å‡½æ•°ï¼‰ï¼Œç”Ÿæˆæè¿° UI ç»“æ„çš„å¯¹è±¡ï¼ˆReact å…ƒç´ ï¼‰ï¼Œè€Œéç›´æ¥æ“ä½œçœŸå® DOMã€‚</p><div class="language-jsx vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">jsx</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// JSX</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> element</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">h1</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> className</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;title&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;Hello, world!&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">h1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// ç¼–è¯‘åï¼ˆReact 17 ä¹‹å‰ï¼‰</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> element</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> React.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">createElement</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;h1&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, { className: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;title&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> }, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;Hello, world!&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// ç¼–è¯‘åï¼ˆReact 17+ï¼Œè‡ªåŠ¨å¼•å…¥ _jsxï¼‰</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { jsx </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">as</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> _jsx } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;react/jsx-runtime&#39;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> element</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> _jsx</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;h1&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, { className: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;title&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, children: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;Hello, world!&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> })</span></span></code></pre></div></li><li><p><strong>è™šæ‹Ÿ DOM çš„è¿ä½œ</strong></p><ul><li>React å…ƒç´ ç»„æˆè™šæ‹Ÿ DOM æ ‘ï¼Œé€šè¿‡ Diff ç®—æ³•å¯¹æ¯”æ–°æ—§æ ‘å·®å¼‚ï¼Œæœ€ç»ˆé«˜æ•ˆæ›´æ–°çœŸå® DOMã€‚</li><li>è™šæ‹Ÿ DOM æ˜¯å†…å­˜ä¸­çš„è½»é‡å¯¹è±¡ï¼Œé¿å…é¢‘ç¹æ“ä½œçœŸå® DOM çš„æ€§èƒ½æŸè€—ã€‚</li></ul></li></ol><p><strong>JSX çš„æ ¸å¿ƒç‰¹æ€§</strong></p><ol><li><p><strong>ç±» HTML è¯­æ³•ä¸ JavaScript çš„èåˆ</strong></p><ul><li><strong>è¡¨è¾¾å¼åµŒå…¥</strong>ï¼šé€šè¿‡ <code>{}</code> åµŒå…¥ JavaScript è¡¨è¾¾å¼ï¼ˆå¦‚å˜é‡ã€å‡½æ•°è°ƒç”¨ã€ä¸‰å…ƒè¿ç®—ç¬¦ï¼‰ï¼š<div class="language-jsx vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">jsx</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> userName</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;Alice&#39;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> element</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">p</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;Hello, {userName.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">toUpperCase</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()}&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">p</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span></code></pre></div></li><li><strong>ç¦æ­¢è¯­å¥</strong>ï¼š<code>{}</code> å†…ä¸æ”¯æŒ <code>if</code>/<code>for</code> ç­‰è¯­å¥ï¼Œéœ€æ”¹ç”¨è¡¨è¾¾å¼ï¼ˆå¦‚ä¸‰å…ƒè¿ç®—ç¬¦æˆ–é€»è¾‘ä¸ï¼‰ï¼š<div class="language-jsx vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">jsx</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">div</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;{isLoggedIn </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">?</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;Welcome&#39;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> :</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;Please Login&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">div</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span></code></pre></div></li></ul></li><li><p><strong>è¯­æ³•è§„åˆ™</strong></p><ul><li><strong>å±æ€§å‘½å</strong>ï¼šä½¿ç”¨é©¼å³°å‘½åï¼ˆå¦‚ <code>className</code> ä»£æ›¿ <code>class</code>ï¼Œ<code>htmlFor</code> ä»£æ›¿ <code>for</code>ï¼‰ã€‚</li><li><strong>é—­åˆæ ‡ç­¾</strong>ï¼šæ‰€æœ‰æ ‡ç­¾å¿…é¡»æ˜¾å¼é—­åˆï¼ˆå¦‚ <code>&lt;img /&gt;</code>ï¼‰ã€‚</li><li><strong>å•ä¸€æ ¹å…ƒç´ </strong>ï¼šJSX å¿…é¡»æœ‰å”¯ä¸€æ ¹å…ƒç´ ï¼ˆæˆ–ç”¨ <code>&lt;&gt;&lt;/&gt;</code> ç©ºæ ‡ç­¾åŒ…è£¹ï¼‰ã€‚</li></ul></li><li><p><strong>å®‰å…¨æ€§</strong></p><ul><li><strong>é»˜è®¤ XSS é˜²æŠ¤</strong>ï¼šJSX è‡ªåŠ¨è½¬ä¹‰åµŒå…¥å†…å®¹ä¸­çš„ç‰¹æ®Šå­—ç¬¦ï¼ˆå¦‚ <code>&lt;</code> è½¬ä¸º <code>&amp;lt;</code>ï¼‰ã€‚</li><li><strong>ä¾‹å¤–åœºæ™¯</strong>ï¼šå¦‚éœ€æ¸²æŸ“åŸå§‹ HTMLï¼Œéœ€æ˜¾å¼ä½¿ç”¨ <code>dangerouslySetInnerHTML</code>ï¼ˆéœ€è°¨æ…ï¼‰ï¼š<div class="language-jsx vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">jsx</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">div</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> dangerouslySetInnerHTML</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{{ __html: userContent }} /&gt;</span></span></code></pre></div></li></ul></li></ol><p><strong>ç¼–è¯‘ä¸å·¥å…·é“¾</strong></p><ol><li><p><strong>ç¼–è¯‘æµç¨‹</strong> JSX éœ€é€šè¿‡ <strong>Babel</strong> ç¼–è¯‘ä¸ºæµè§ˆå™¨å¯æ‰§è¡Œçš„ JavaScriptã€‚å…¸å‹é…ç½®å¦‚ä¸‹ï¼š</p><div class="language-json vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// .babelrc</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;presets&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: [</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;@babel/preset-react&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div></li><li><p><strong>React 17+ çš„ä¼˜åŒ–</strong></p><ul><li>æ— éœ€æ‰‹åŠ¨å¯¼å…¥ Reactï¼šç¼–è¯‘å™¨è‡ªåŠ¨å¼•å…¥ <code>_jsx</code> å‡½æ•°ã€‚</li><li>æ›´ç®€æ´çš„ç¼–è¯‘è¾“å‡ºï¼šå‡å°‘ä»£ç ä½“ç§¯ï¼Œæå‡å¯è¯»æ€§ã€‚</li></ul></li></ol></details><p>å‚è€ƒèµ„æ–™</p><details class="details custom-block"><summary>Details</summary><ul><li><a href="https://juejin.cn/post/7348651815759282226" target="_blank" rel="noreferrer">https://juejin.cn/post/7348651815759282226</a></li></ul></details><h2 id="å¦‚ä½•ç†è§£-react-fiber-æ¶æ„" tabindex="-1">å¦‚ä½•ç†è§£ React Fiber æ¶æ„ï¼Ÿ <a class="header-anchor" href="#å¦‚ä½•ç†è§£-react-fiber-æ¶æ„" aria-label="Permalink to &quot;å¦‚ä½•ç†è§£ React Fiber æ¶æ„ï¼Ÿ&quot;">â€‹</a></h2><p>å‚è€ƒç­”æ¡ˆ</p><details class="details custom-block"><summary>Details</summary><ol><li><strong>Fiber æ¶æ„çš„æœ¬è´¨ä¸è®¾è®¡ç›®æ ‡</strong></li></ol><p>Fiber æ˜¯ React 16+ çš„<strong>æ ¸å¿ƒç®—æ³•é‡å†™</strong>ï¼Œæœ¬è´¨æ˜¯<strong>åŸºäºé“¾è¡¨çš„å¢é‡å¼åè°ƒæ¨¡å‹</strong>ã€‚å…¶æ ¸å¿ƒç›®æ ‡å¹¶éå•çº¯æå‡æ€§èƒ½ï¼Œè€Œæ˜¯é‡æ„æ¶æ„ä»¥å®ç°ï¼š</p><ul><li><strong>å¯ä¸­æ–­çš„å¼‚æ­¥æ¸²æŸ“</strong>ï¼šå°†åŒæ­¥é€’å½’çš„è°ƒå’Œè¿‡ç¨‹æ‹†è§£ä¸ºå¯æš‚åœ/æ¢å¤çš„å¼‚æ­¥ä»»åŠ¡ã€‚</li><li><strong>ä¼˜å…ˆçº§è°ƒåº¦</strong>ï¼šé«˜ä¼˜å…ˆçº§ä»»åŠ¡ï¼ˆå¦‚ç”¨æˆ·è¾“å…¥ï¼‰å¯æ‰“æ–­ä½ä¼˜å…ˆçº§ä»»åŠ¡ï¼ˆå¦‚æ•°æ®æ›´æ–°ï¼‰ã€‚</li><li><strong>å¹¶å‘æ¨¡å¼åŸºç¡€</strong>ï¼šä¸º <code>Suspense</code>ã€<code>useTransition</code> ç­‰ç‰¹æ€§æä¾›åº•å±‚æ”¯æŒã€‚</li></ul><ol start="2"><li><strong>Fiber èŠ‚ç‚¹çš„æ ¸å¿ƒè®¾è®¡</strong></li></ol><p>æ¯ä¸ªç»„ä»¶å¯¹åº”ä¸€ä¸ª <strong>Fiber èŠ‚ç‚¹</strong>ï¼Œæ„æˆ<strong>åŒå‘é“¾è¡¨æ ‘ç»“æ„</strong>ï¼ŒåŒ…å«ä»¥ä¸‹å…³é”®ä¿¡æ¯ï¼š</p><ul><li><strong>ç»„ä»¶ç±»å‹</strong>ï¼šå‡½æ•°ç»„ä»¶ã€ç±»ç»„ä»¶æˆ–åŸç”Ÿæ ‡ç­¾ã€‚</li><li><strong>çŠ¶æ€ä¸å‰¯ä½œç”¨</strong>ï¼šHooks çŠ¶æ€ï¼ˆå¦‚ <code>useState</code>ï¼‰ã€ç”Ÿå‘½å‘¨æœŸæ ‡è®°ï¼ˆå¦‚ <code>useEffect</code>ï¼‰ã€‚</li><li><strong>è°ƒåº¦ä¿¡æ¯</strong>ï¼šä»»åŠ¡ä¼˜å…ˆçº§ï¼ˆ<code>lane</code> æ¨¡å‹ï¼‰ã€åˆ°æœŸæ—¶é—´ï¼ˆ<code>expirationTime</code>ï¼‰ã€‚</li><li><strong>é“¾è¡¨æŒ‡é’ˆ</strong>ï¼š<code>child</code>ï¼ˆå­èŠ‚ç‚¹ï¼‰ã€<code>sibling</code>ï¼ˆå…„å¼ŸèŠ‚ç‚¹ï¼‰ã€<code>return</code>ï¼ˆçˆ¶èŠ‚ç‚¹ï¼‰ã€‚</li></ul><div class="language-javascript vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// Fiber èŠ‚ç‚¹ç»“æ„ç®€åŒ–ç¤ºä¾‹</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> fiberNode</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  tag: FunctionComponent, </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// ç»„ä»¶ç±»å‹</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  stateNode: ComponentFunc, </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// ç»„ä»¶å®ä¾‹æˆ– DOM èŠ‚ç‚¹</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  memoizedState: {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    /* Hooks é“¾è¡¨ */</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  },</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  pendingProps: {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    /* å¾…å¤„ç† props */</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  },</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  lanes: Lanes.HighPriority, </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// ä»»åŠ¡ä¼˜å…ˆçº§</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  child: nextFiber, </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// å­èŠ‚ç‚¹</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  sibling: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">null</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// å…„å¼ŸèŠ‚ç‚¹</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  return: parentFiber, </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// çˆ¶èŠ‚ç‚¹</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><ol start="3"><li><strong>Fiber åè°ƒæµç¨‹ï¼ˆä¸¤é˜¶æ®µæäº¤ï¼‰</strong></li></ol><p><strong>é˜¶æ®µ 1ï¼šReconciliationï¼ˆåè°ƒ/æ¸²æŸ“é˜¶æ®µï¼‰</strong></p><ul><li><strong>å¯ä¸­æ–­çš„å¢é‡è®¡ç®—</strong>ï¼š React å°†ç»„ä»¶æ ‘éå†æ‹†è§£ä¸ºå¤šä¸ª <strong>Fiber å·¥ä½œå•å…ƒ</strong>ï¼Œé€šè¿‡å¾ªç¯ï¼ˆè€Œéé€’å½’ï¼‰é€ä¸ªå¤„ç†ã€‚ <ul><li>æ¯æ¬¡å¾ªç¯æ‰§è¡Œä¸€ä¸ª Fiber èŠ‚ç‚¹ï¼Œç”Ÿæˆå­ Fiber å¹¶è¿æ¥æˆæ ‘ã€‚</li><li>é€šè¿‡ <code>requestIdleCallback</code>ï¼ˆæˆ– Scheduler åŒ…ï¼‰åœ¨æµè§ˆå™¨ç©ºé—²æ—¶æ®µæ‰§è¡Œï¼Œé¿å…é˜»å¡ä¸»çº¿ç¨‹ã€‚</li></ul></li><li><strong>å¯¹æ¯”ç­–ç•¥</strong>ï¼š æ ¹æ® <code>key</code> å’Œ <code>type</code> å¤ç”¨èŠ‚ç‚¹ï¼Œæ ‡è®° <code>Placement</code>ï¼ˆæ–°å¢ï¼‰ã€<code>Update</code>ï¼ˆæ›´æ–°ï¼‰ã€<code>Deletion</code>ï¼ˆåˆ é™¤ï¼‰ç­‰å‰¯ä½œç”¨ã€‚</li></ul><p><strong>é˜¶æ®µ 2ï¼šCommitï¼ˆæäº¤é˜¶æ®µï¼‰</strong></p><ul><li><strong>ä¸å¯ä¸­æ–­çš„ DOM æ›´æ–°</strong>ï¼š åŒæ­¥æ‰§è¡Œæ‰€æœ‰æ ‡è®°çš„å‰¯ä½œç”¨ï¼ˆå¦‚ DOM æ“ä½œã€ç”Ÿå‘½å‘¨æœŸè°ƒç”¨ï¼‰ï¼Œç¡®ä¿ UI ä¸€è‡´æ€§ã€‚</li><li><strong>å‰¯ä½œç”¨åˆ†ç±»</strong>ï¼š <ul><li><strong>BeforeMutation</strong>ï¼š<code>getSnapshotBeforeUpdate</code>ã€‚</li><li><strong>Mutation</strong>ï¼šDOM æ’å…¥/æ›´æ–°/åˆ é™¤ã€‚</li><li><strong>Layout</strong>ï¼š<code>useLayoutEffect</code>ã€<code>componentDidMount</code>/<code>Update</code>ã€‚</li></ul></li></ul><ol start="4"><li><strong>ä¼˜å…ˆçº§è°ƒåº¦æœºåˆ¶</strong></li></ol><p>React é€šè¿‡ <strong>Lane æ¨¡å‹</strong> ç®¡ç†ä»»åŠ¡ä¼˜å…ˆçº§ï¼ˆå…± 31 ä¸ªä¼˜å…ˆçº§è½¦é“ï¼‰ï¼š</p><ul><li><strong>äº‹ä»¶ä¼˜å…ˆçº§</strong>ï¼š<div class="language-javascript vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// ä¼˜å…ˆçº§ä»é«˜åˆ°ä½</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">ImmediatePriorityï¼ˆç”¨æˆ·è¾“å…¥ï¼‰</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">UserBlockingPriorityï¼ˆæ‚¬åœã€ç‚¹å‡»ï¼‰</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">NormalPriorityï¼ˆæ•°æ®è¯·æ±‚ï¼‰</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">LowPriorityï¼ˆåˆ†ææ—¥å¿—ï¼‰</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">IdlePriorityï¼ˆéå¿…è¦ä»»åŠ¡ï¼‰</span></span></code></pre></div></li><li><strong>è°ƒåº¦ç­–ç•¥</strong>ï¼š <ul><li>é«˜ä¼˜å…ˆçº§ä»»åŠ¡å¯æŠ¢å ä½ä¼˜å…ˆçº§ä»»åŠ¡çš„æ‰§è¡Œæƒã€‚</li><li>è¿‡æœŸä»»åŠ¡ï¼ˆå¦‚ Suspense å›é€€ï¼‰ä¼šè¢«å¼ºåˆ¶åŒæ­¥æ‰§è¡Œã€‚</li></ul></li></ul><ol start="5"><li><strong>Fiber æ¶æ„çš„ä¼˜åŠ¿ä¸å±€é™æ€§</strong></li></ol><p><strong>ä¼˜åŠ¿</strong></p><ul><li><strong>æµç•…çš„ç”¨æˆ·ä½“éªŒ</strong>ï¼šå¼‚æ­¥æ¸²æŸ“é¿å…ä¸»çº¿ç¨‹é˜»å¡ï¼Œä¿éšœé«˜ä¼˜å…ˆçº§ä»»åŠ¡å³æ—¶å“åº”ã€‚</li><li><strong>å¤æ‚åœºæ™¯ä¼˜åŒ–</strong>ï¼šæ”¯æŒå¤§è§„æ¨¡ç»„ä»¶æ ‘çš„é«˜æ•ˆæ›´æ–°ï¼ˆå¦‚è™šæ‹Ÿæ»šåŠ¨ã€åŠ¨ç”»ä¸²è”ï¼‰ã€‚</li><li><strong>æœªæ¥ç‰¹æ€§åŸºç¡€</strong>ï¼šä¸ºå¹¶å‘æ¨¡å¼ï¼ˆConcurrent Modeï¼‰ã€ç¦»çº¿æ¸²æŸ“ï¼ˆSSRï¼‰æä¾›åº•å±‚æ”¯æŒã€‚</li></ul><p><strong>å±€é™æ€§</strong></p><ul><li><strong>å­¦ä¹ æˆæœ¬é«˜</strong>ï¼šå¼€å‘è€…éœ€ç†è§£åº•å±‚è°ƒåº¦é€»è¾‘ä»¥ä¼˜åŒ–æ€§èƒ½ã€‚</li><li><strong>å†…å­˜å¼€é”€</strong>ï¼šFiber æ ‘çš„åŒå‘é“¾è¡¨ç»“æ„æ¯”ä¼ ç»Ÿè™šæ‹Ÿ DOM å ç”¨æ›´å¤šå†…å­˜ã€‚</li></ul><ol start="6"><li><strong>ä¸æ—§æ¶æ„çš„å…³é”®å·®å¼‚</strong></li></ol><table tabindex="0"><thead><tr><th>ç‰¹æ€§</th><th>Stack Reconcilerï¼ˆReact 15-ï¼‰</th><th>Fiber Reconcilerï¼ˆReact 16+ï¼‰</th></tr></thead><tbody><tr><td><strong>éå†æ–¹å¼</strong></td><td>é€’å½’ï¼ˆä¸å¯ä¸­æ–­ï¼‰</td><td>å¾ªç¯ï¼ˆå¯ä¸­æ–­ + æ¢å¤ï¼‰</td></tr><tr><td><strong>ä»»åŠ¡è°ƒåº¦</strong></td><td>åŒæ­¥æ‰§è¡Œï¼Œé˜»å¡ä¸»çº¿ç¨‹</td><td>å¼‚æ­¥åˆ†ç‰‡ï¼Œç©ºé—²æ—¶æ®µæ‰§è¡Œ</td></tr><tr><td><strong>ä¼˜å…ˆçº§æ§åˆ¶</strong></td><td>æ— </td><td>åŸºäº Lane æ¨¡å‹çš„ä¼˜å…ˆçº§æŠ¢å </td></tr><tr><td><strong>æ•°æ®ç»“æ„</strong></td><td>è™šæ‹Ÿ DOM æ ‘</td><td>Fiber é“¾è¡¨æ ‘ï¼ˆå«è°ƒåº¦ä¿¡æ¯ï¼‰</td></tr></tbody></table></details><h2 id="fiber-ç»“æ„å’Œæ™®é€š-vnode-åŒºåˆ«" tabindex="-1">Fiber ç»“æ„å’Œæ™®é€š VNode åŒºåˆ« <a class="header-anchor" href="#fiber-ç»“æ„å’Œæ™®é€š-vnode-åŒºåˆ«" aria-label="Permalink to &quot;Fiber ç»“æ„å’Œæ™®é€š VNode åŒºåˆ«&quot;">â€‹</a></h2><p>å‚è€ƒç­”æ¡ˆ</p><details class="details custom-block"><summary>Details</summary><ol><li><strong>æœ¬è´¨å·®å¼‚</strong></li></ol><table tabindex="0"><thead><tr><th>ç»´åº¦</th><th>æ™®é€š VNodeï¼ˆè™šæ‹Ÿ DOMï¼‰</th><th>Fiber ç»“æ„</th></tr></thead><tbody><tr><td><strong>è®¾è®¡ç›®æ ‡</strong></td><td>å‡å°‘çœŸå® DOM æ“ä½œï¼Œæå‡æ¸²æŸ“æ€§èƒ½</td><td>å®ç°å¯ä¸­æ–­çš„å¼‚æ­¥æ¸²æŸ“ + ä¼˜å…ˆçº§è°ƒåº¦</td></tr><tr><td><strong>æ•°æ®ç»“æ„</strong></td><td>æ ‘å½¢ç»“æ„ï¼ˆé€’å½’éå†ï¼‰</td><td>åŒå‘é“¾è¡¨æ ‘ï¼ˆå¾ªç¯éå†ï¼‰</td></tr><tr><td><strong>åŠŸèƒ½èŒƒç•´</strong></td><td>ä»…æè¿° UI ç»“æ„</td><td>æè¿° UI ç»“æ„ + è°ƒåº¦ä»»åŠ¡ + å‰¯ä½œç”¨ç®¡ç†</td></tr></tbody></table><ol start="2"><li><strong>æ•°æ®ç»“æ„å¯¹æ¯”</strong></li></ol><p><strong>æ™®é€š VNodeï¼ˆReact 15 åŠä¹‹å‰ï¼‰</strong></p><div class="language-javascript vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> vNode</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  type: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;div&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// èŠ‚ç‚¹ç±»å‹ï¼ˆç»„ä»¶/åŸç”Ÿæ ‡ç­¾ï¼‰</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  props: { className: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;container&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> }, </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// å±æ€§</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  children: [vNode1, vNode2], </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// å­èŠ‚ç‚¹ï¼ˆæ ‘å½¢ç»“æ„ï¼‰</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  key: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;unique-id&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// ä¼˜åŒ– Diff æ€§èƒ½</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  // æ— çŠ¶æ€ã€è°ƒåº¦ã€å‰¯ä½œç”¨ä¿¡æ¯</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><ul><li><strong>æ ¸å¿ƒå­—æ®µ</strong>ï¼šä»…åŒ…å« UI æè¿°ç›¸å…³å±æ€§ï¼ˆtypeã€propsã€childrenï¼‰ã€‚</li></ul><p><strong>Fiber èŠ‚ç‚¹ï¼ˆReact 16+ï¼‰</strong></p><div class="language-javascript vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> fiberNode</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  tag: HostComponent, </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// èŠ‚ç‚¹ç±»å‹ï¼ˆå‡½æ•°ç»„ä»¶/ç±»ç»„ä»¶/DOMå…ƒç´ ï¼‰</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  type: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;div&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// åŸç”Ÿæ ‡ç­¾æˆ–ç»„ä»¶æ„é€ å‡½æ•°</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  key: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;unique-id&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// Diff ä¼˜åŒ–æ ‡è¯†</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  stateNode: domNode, </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// å…³è”çš„çœŸå® DOM èŠ‚ç‚¹</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  pendingProps: { className: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;container&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> }, </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// å¾…å¤„ç†çš„ props</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  memoizedProps: {}, </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// å·²ç”Ÿæ•ˆçš„ props</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  memoizedState: {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    // Hooks çŠ¶æ€ï¼ˆå‡½æ•°ç»„ä»¶ï¼‰</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    hooks: [state1, effectHook],</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  },</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  updateQueue: [], </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// çŠ¶æ€æ›´æ–°é˜Ÿåˆ—ï¼ˆç±»ç»„ä»¶ï¼‰</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  lanes: Lanes.HighPriority, </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// è°ƒåº¦ä¼˜å…ˆçº§ï¼ˆLane æ¨¡å‹ï¼‰</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  child: childFiber, </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// ç¬¬ä¸€ä¸ªå­èŠ‚ç‚¹</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  sibling: siblingFiber, </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// ä¸‹ä¸€ä¸ªå…„å¼ŸèŠ‚ç‚¹</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  return: parentFiber, </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// çˆ¶èŠ‚ç‚¹ï¼ˆæ„æˆåŒå‘é“¾è¡¨ï¼‰</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  effectTag: Placement, </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// å‰¯ä½œç”¨æ ‡è®°ï¼ˆæ’å…¥/æ›´æ–°/åˆ é™¤ï¼‰</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  nextEffect: nextEffectFiber, </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// å‰¯ä½œç”¨é“¾è¡¨æŒ‡é’ˆ</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><ul><li><strong>æ ¸å¿ƒæ‰©å±•</strong>ï¼š <ul><li><strong>è°ƒåº¦æ§åˆ¶</strong>ï¼š<code>lanes</code> ä¼˜å…ˆçº§ã€ä»»åŠ¡åˆ°æœŸæ—¶é—´ã€‚</li><li><strong>çŠ¶æ€ç®¡ç†</strong>ï¼šHooks é“¾è¡¨ï¼ˆå‡½æ•°ç»„ä»¶ï¼‰ã€ç±»ç»„ä»¶çŠ¶æ€é˜Ÿåˆ—ã€‚</li><li><strong>å‰¯ä½œç”¨è¿½è¸ª</strong>ï¼š<code>effectTag</code> æ ‡è®°å’Œå‰¯ä½œç”¨é“¾è¡¨ã€‚</li><li><strong>éå†ç»“æ„</strong>ï¼š<code>child</code>/<code>sibling</code>/<code>return</code> æ„æˆåŒå‘é“¾è¡¨ã€‚</li></ul></li></ul><ol start="3"><li><strong>åè°ƒæœºåˆ¶å¯¹æ¯”</strong></li></ol><table tabindex="0"><thead><tr><th>æµç¨‹</th><th>VNodeï¼ˆStack Reconcilerï¼‰</th><th>Fiber Reconciler</th></tr></thead><tbody><tr><td><strong>éå†æ–¹å¼</strong></td><td>é€’å½’éå†ï¼ˆä¸å¯ä¸­æ–­ï¼‰</td><td>å¾ªç¯éå†é“¾è¡¨ï¼ˆå¯ä¸­æ–­ + æ¢å¤ï¼‰</td></tr><tr><td><strong>ä»»åŠ¡è°ƒåº¦</strong></td><td>åŒæ­¥æ‰§è¡Œï¼Œé˜»å¡ä¸»çº¿ç¨‹</td><td>å¼‚æ­¥åˆ†ç‰‡ï¼Œç©ºé—²æ—¶é—´æ‰§è¡Œ</td></tr><tr><td><strong>ä¼˜å…ˆçº§æ§åˆ¶</strong></td><td>æ— </td><td>Lane æ¨¡å‹ï¼ˆ31 ä¸ªä¼˜å…ˆçº§è½¦é“ï¼‰</td></tr><tr><td><strong>å‰¯ä½œç”¨å¤„ç†</strong></td><td>ç»Ÿä¸€æäº¤ DOM æ›´æ–°</td><td>æ„å»ºå‰¯ä½œç”¨é“¾è¡¨ï¼Œåˆ†é˜¶æ®µæäº¤</td></tr></tbody></table><ul><li><strong>Fiber ä¸¤é˜¶æ®µæäº¤</strong>ï¼š <ol><li><strong>åè°ƒé˜¶æ®µ</strong>ï¼ˆå¯ä¸­æ–­ï¼‰ï¼š <ul><li>å¢é‡æ„å»º Fiber æ ‘ï¼Œæ ‡è®°å‰¯ä½œç”¨ï¼ˆ<code>effectTag</code>ï¼‰ã€‚</li><li>é€šè¿‡ <code>requestIdleCallback</code> æˆ– Scheduler åŒ…åˆ†ç‰‡æ‰§è¡Œã€‚</li></ul></li><li><strong>æäº¤é˜¶æ®µ</strong>ï¼ˆåŒæ­¥ä¸å¯ä¸­æ–­ï¼‰ï¼š <ul><li>éå†å‰¯ä½œç”¨é“¾è¡¨ï¼Œæ‰§è¡Œ DOM æ“ä½œå’Œç”Ÿå‘½å‘¨æœŸæ–¹æ³•ã€‚</li></ul></li></ol></li></ul><ol start="4"><li><p><strong>èƒ½åŠ›æ‰©å±•ç¤ºä¾‹</strong></p><p><strong>a. æ”¯æŒ Hooks çŠ¶æ€ç®¡ç†</strong></p></li></ol><ul><li>Fiber èŠ‚ç‚¹é€šè¿‡ <code>memoizedState</code> å­—æ®µå­˜å‚¨ Hooks é“¾è¡¨ï¼š</li></ul><div class="language-javascript vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// å‡½æ•°ç»„ä»¶çš„ Hooks é“¾è¡¨</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">fiberNode.memoizedState </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  memoizedState: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;state value&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// useState çš„çŠ¶æ€</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  next: {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    // ä¸‹ä¸€ä¸ª Hookï¼ˆå¦‚ useEffectï¼‰</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    memoizedState: { cleanup: fn },</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    next: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">null</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  },</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><ul><li>VNode æ— çŠ¶æ€ç®¡ç†èƒ½åŠ›ï¼Œä»…æè¿° UIã€‚</li></ul><p><strong>b. ä¼˜å…ˆçº§è°ƒåº¦å®æˆ˜</strong></p><ul><li><strong>é«˜ä¼˜å…ˆçº§ä»»åŠ¡æŠ¢å </strong>ï¼š<div class="language-javascript vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// ç”¨æˆ·è¾“å…¥è§¦å‘é«˜ä¼˜å…ˆçº§æ›´æ–°</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">input.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">addEventListener</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;input&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, () </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  React.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">startTransition</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(() </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    setInputValue</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(e.target.value) </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// ä½ä¼˜å…ˆçº§</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  })</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  // é«˜ä¼˜å…ˆçº§æ›´æ–°ç«‹å³æ‰§è¡Œ</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">})</span></span></code></pre></div></li><li>VNode æ¶æ„æ— æ³•å®ç°ä»»åŠ¡ä¸­æ–­å’Œä¼˜å…ˆçº§æ’é˜Ÿã€‚</li></ul><p><strong>c. å‰¯ä½œç”¨æ‰¹å¤„ç†</strong></p><ul><li>Fiber é€šè¿‡ <code>effectList</code> é“¾è¡¨æ”¶é›†æ‰€æœ‰å˜æ›´ï¼Œç»Ÿä¸€æäº¤ï¼š<div class="language-javascript vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// æäº¤é˜¶æ®µéå† effectList</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">let</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> nextEffect </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> fiberRoot.firstEffect</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">while</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (nextEffect) {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  commitWork</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(nextEffect)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  nextEffect </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> nextEffect.nextEffect</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div></li><li>VNode æ¶æ„åœ¨ Diff åç›´æ¥æ“ä½œ DOMï¼Œæ— æ‰¹å¤„ç†ä¼˜åŒ–ã€‚</li></ul><ol start="5"><li><strong>æ€§èƒ½å½±å“å¯¹æ¯”</strong></li></ol><table tabindex="0"><thead><tr><th>åœºæ™¯</th><th>VNode æ¶æ„</th><th>Fiber æ¶æ„</th></tr></thead><tbody><tr><td><strong>å¤§å‹ç»„ä»¶æ ‘æ¸²æŸ“</strong></td><td>ä¸»çº¿ç¨‹é˜»å¡å¯¼è‡´æ‰å¸§</td><td>åˆ†ç‰‡æ¸²æŸ“ï¼Œä¿æŒ UI å“åº”</td></tr><tr><td><strong>é«˜é¢‘æ›´æ–°ï¼ˆå¦‚åŠ¨ç”»ï¼‰</strong></td><td>å¤šæ¬¡æ¸²æŸ“åˆå¹¶å›°éš¾</td><td>åŸºäºä¼˜å…ˆçº§åˆå¹¶æˆ–è·³è¿‡ä¸­é—´çŠ¶æ€</td></tr><tr><td><strong>SSR æ°´åˆï¼ˆHydrationï¼‰</strong></td><td>å…¨é‡åŒæ­¥å¤„ç†</td><td>å¢é‡æ°´åˆï¼Œä¼˜å…ˆäº¤äº’éƒ¨åˆ†</td></tr></tbody></table></details><h2 id="ç®€è¿°-react-diff-ç®—æ³•è¿‡ç¨‹" tabindex="-1">ç®€è¿° React diff ç®—æ³•è¿‡ç¨‹ <a class="header-anchor" href="#ç®€è¿°-react-diff-ç®—æ³•è¿‡ç¨‹" aria-label="Permalink to &quot;ç®€è¿° React diff ç®—æ³•è¿‡ç¨‹&quot;">â€‹</a></h2><p>å‚è€ƒç­”æ¡ˆ</p><details class="details custom-block"><summary>Details</summary><p>React Diff ç®—æ³•é€šè¿‡ <strong>åˆ†å±‚å¯¹æ¯”ç­–ç•¥</strong> å’Œ <strong>å¯å‘å¼è§„åˆ™</strong> å‡å°‘æ ‘å¯¹æ¯”çš„æ—¶é—´å¤æ‚åº¦ï¼ˆä» O(nÂ³) ä¼˜åŒ–è‡³ O(n)ï¼‰ã€‚å…¶æ ¸å¿ƒæµç¨‹å¦‚ä¸‹ï¼š</p><p><strong>1. åˆ†å±‚å¯¹æ¯”ç­–ç•¥</strong></p><p>React ä»…å¯¹ <strong>åŒä¸€å±‚çº§çš„å…„å¼ŸèŠ‚ç‚¹</strong> è¿›è¡Œå¯¹æ¯”ï¼Œè‹¥èŠ‚ç‚¹è·¨å±‚çº§ç§»åŠ¨ï¼ˆå¦‚ä»çˆ¶èŠ‚ç‚¹ A ç§»åŠ¨åˆ°çˆ¶èŠ‚ç‚¹ Bï¼‰ï¼Œåˆ™ç›´æ¥ <strong>é”€æ¯å¹¶é‡å»º</strong>ï¼Œè€Œéç§»åŠ¨ã€‚ <strong>åŸå› </strong>ï¼šè·¨å±‚æ“ä½œåœ¨çœŸå® DOM ä¸­æˆæœ¬æé«˜ï¼ˆéœ€é€’å½’éå†å­æ ‘ï¼‰ï¼Œè€Œå®é™…å¼€å‘ä¸­è·¨å±‚ç§»åŠ¨åœºæ™¯æå°‘ï¼Œæ­¤ç­–ç•¥ä»¥æ¦‚ç‡æ¢æ€§èƒ½ã€‚</p><p><strong>2. èŠ‚ç‚¹ç±»å‹æ¯”å¯¹è§„åˆ™</strong></p><p><strong>a. å…ƒç´ ç±»å‹ä¸åŒ</strong></p><p>è‹¥æ–°æ—§èŠ‚ç‚¹ç±»å‹ä¸åŒï¼ˆå¦‚ <code>&lt;div&gt;</code> â†’ <code>&lt;span&gt;</code> æˆ– <code>ComponentA</code> â†’ <code>ComponentB</code>ï¼‰ï¼Œåˆ™ï¼š</p><ol><li>é”€æ¯æ—§èŠ‚ç‚¹åŠå…¶å­æ ‘ã€‚</li><li>åˆ›å»ºæ–°èŠ‚ç‚¹åŠå­æ ‘ï¼Œå¹¶æ’å…¥ DOMã€‚</li></ol><div class="language-jsx vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">jsx</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// æ—§æ ‘</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">div</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  &lt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">ComponentA</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> /&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">div</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// æ–°æ ‘ â†’ ç›´æ¥æ›¿æ¢</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">span</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  &lt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">ComponentB</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> /&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">span</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span></code></pre></div><p><strong>b. å…ƒç´ ç±»å‹ç›¸åŒ</strong></p><p>è‹¥ç±»å‹ç›¸åŒï¼Œåˆ™å¤ç”¨ DOM èŠ‚ç‚¹å¹¶æ›´æ–°å±æ€§ï¼š</p><ul><li><strong>åŸç”Ÿæ ‡ç­¾</strong>ï¼šæ›´æ–° <code>className</code>ã€<code>style</code> ç­‰å±æ€§ã€‚</li><li><strong>ç»„ä»¶ç±»å‹</strong>ï¼š <ul><li>ç±»ç»„ä»¶ï¼šä¿ç•™å®ä¾‹ï¼Œè§¦å‘ <code>componentWillReceiveProps</code> â†’ <code>shouldComponentUpdate</code> ç­‰ç”Ÿå‘½å‘¨æœŸã€‚</li><li>å‡½æ•°ç»„ä»¶ï¼šé‡æ–°æ‰§è¡Œå‡½æ•°ï¼Œé€šè¿‡ Hooks çŠ¶æ€åˆ¤æ–­æ˜¯å¦éœ€æ›´æ–°ã€‚</li></ul></li></ul><div class="language-jsx vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">jsx</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// æ—§ç»„ä»¶ï¼ˆä¿ç•™å®ä¾‹å¹¶æ›´æ–° propsï¼‰</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Button</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> className</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;old&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> onClick</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{handleClick} /&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// æ–°ç»„ä»¶ â†’ å¤ç”¨ DOMï¼Œæ›´æ–° className å’Œ onClick</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Button</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> className</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;new&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> onClick</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{newClick} /&gt;</span></span></code></pre></div><p><strong>3. åˆ—è¡¨èŠ‚ç‚¹çš„ Key ä¼˜åŒ–</strong></p><p>å¤„ç†å­èŠ‚ç‚¹åˆ—è¡¨æ—¶ï¼ŒReact ä¾èµ– <strong>key</strong> è¿›è¡Œæœ€å°åŒ–æ›´æ–°ï¼š</p><p><strong>a. æ—  key æ—¶çš„é»˜è®¤è¡Œä¸º</strong></p><p>é»˜è®¤ä½¿ç”¨ <strong>ç´¢å¼•åŒ¹é…</strong>ï¼ˆindex-based diffï¼‰ï¼Œå¯èƒ½å¯¼è‡´æ€§èƒ½é—®é¢˜ï¼š</p><div class="language-jsx vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">jsx</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// æ—§åˆ—è¡¨</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;[&lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">div</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;A&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">div</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;, &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">div</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;B&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">div</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;][</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  // æ–°åˆ—è¡¨ï¼ˆé¦–éƒ¨æ’å…¥ï¼‰â†’ ç´¢å¼•å¯¹æ¯”å¯¼è‡´ B è¢«è¯¯åˆ¤æ›´æ–°</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  ((&lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">div</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;C&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">div</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;), (&lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">div</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;A&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">div</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;), (&lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">div</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;B&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">div</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;))</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span></code></pre></div><p>æ­¤æ—¶ React ä¼šè®¤ä¸ºç´¢å¼• 0 ä» A â†’ Cï¼ˆæ›´æ–°ï¼‰ï¼Œç´¢å¼• 1 ä» B â†’ Aï¼ˆæ›´æ–°ï¼‰ï¼Œå¹¶æ–°å¢ç´¢å¼• 2 çš„ Bï¼Œå®é™…åº”ä»…æ’å…¥ Cã€‚</p><p><strong>b. ä½¿ç”¨ key çš„ä¼˜åŒ–åŒ¹é…</strong></p><p>é€šè¿‡å”¯ä¸€ key æ ‡è¯†èŠ‚ç‚¹èº«ä»½ï¼ŒReact å¯ç²¾å‡†è¯†åˆ«ç§»åŠ¨/æ–°å¢/åˆ é™¤ï¼š</p><div class="language-jsx vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">jsx</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// æ­£ç¡®ä½¿ç”¨ keyï¼ˆå¦‚æ•°æ® IDï¼‰</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">ul</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  {items.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">map</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">((</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">item</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">li</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> key</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{item.id}&gt;{item.text}&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">li</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  ))}</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">ul</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span></code></pre></div><p><strong>åŒ¹é…è§„åˆ™</strong>ï¼š</p><ol><li><p>éå†æ–°åˆ—è¡¨ï¼Œé€šè¿‡ key æŸ¥æ‰¾æ—§èŠ‚ç‚¹ï¼š</p><ul><li>æ‰¾åˆ°ä¸”ç±»å‹ç›¸åŒ â†’ å¤ç”¨èŠ‚ç‚¹ã€‚</li><li>æœªæ‰¾åˆ° â†’ æ–°å»ºèŠ‚ç‚¹ã€‚</li></ul></li><li><p>è®°å½•æ—§èŠ‚ç‚¹ä¸­æœªè¢«å¤ç”¨çš„èŠ‚ç‚¹ â†’ æ‰§è¡Œåˆ é™¤ã€‚</p></li></ol><p><strong>c. èŠ‚ç‚¹ç§»åŠ¨ä¼˜åŒ–</strong></p><p>è‹¥æ–°æ—§åˆ—è¡¨èŠ‚ç‚¹ä»…é¡ºåºå˜åŒ–ï¼ŒReact é€šè¿‡ key åŒ¹é…åï¼Œä»…æ‰§è¡Œ <strong>DOM ç§»åŠ¨æ“ä½œ</strong>ï¼ˆéé‡å»ºï¼‰ï¼Œä¾‹å¦‚ï¼š</p><div class="language-jsx vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">jsx</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// æ—§åˆ—è¡¨ï¼šA (key=1), B (key=2)</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// æ–°åˆ—è¡¨ï¼šB (key=2), A (key=1)</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// React ä»…äº¤æ¢ DOM é¡ºåºï¼Œè€Œéé”€æ¯é‡å»º</span></span></code></pre></div><p><strong>4. æ€§èƒ½è¾¹ç•Œç­–ç•¥</strong></p><ul><li><strong>å­æ ‘è·³è¿‡</strong>ï¼šè‹¥çˆ¶èŠ‚ç‚¹ç±»å‹å˜åŒ–ï¼Œå…¶å­èŠ‚ç‚¹å³ä½¿æœªå˜åŒ–ä¹Ÿä¼šè¢«æ•´ä½“é”€æ¯ã€‚</li><li><strong>ç›¸åŒç»„ä»¶æå‰ç»ˆæ­¢</strong>ï¼šè‹¥ç»„ä»¶ <code>shouldComponentUpdate</code> è¿”å› <code>false</code>ï¼Œåˆ™è·³è¿‡å…¶å­æ ‘ Diffã€‚</li></ul></details><h2 id="react-å’Œ-vue-diff-ç®—æ³•çš„åŒºåˆ«" tabindex="-1">React å’Œ Vue diff ç®—æ³•çš„åŒºåˆ« <a class="header-anchor" href="#react-å’Œ-vue-diff-ç®—æ³•çš„åŒºåˆ«" aria-label="Permalink to &quot;React å’Œ Vue diff ç®—æ³•çš„åŒºåˆ«&quot;">â€‹</a></h2><p>å‚è€ƒç­”æ¡ˆ</p><details class="details custom-block"><summary>Details</summary><p>React å’Œ Vue çš„ Diff ç®—æ³•å‡åŸºäºè™šæ‹Ÿ DOMï¼Œä½†åœ¨å®ç°ç­–ç•¥ã€ä¼˜åŒ–æ‰‹æ®µå’Œè®¾è®¡å“²å­¦ä¸Šå­˜åœ¨æ˜¾è‘—å·®å¼‚ï¼š</p><p><strong>1. æ ¸å¿ƒç®—æ³•ç­–ç•¥å¯¹æ¯”</strong></p><table tabindex="0"><thead><tr><th><strong>ç»´åº¦</strong></th><th><strong>React</strong></th><th><strong>Vue 2/3</strong></th></tr></thead><tbody><tr><td><strong>éå†æ–¹å¼</strong></td><td>å•å‘é€’å½’ï¼ˆåŒå±‚é¡ºåºå¯¹æ¯”ï¼‰</td><td>åŒç«¯å¯¹æ¯”ï¼ˆå¤´å°¾æŒ‡é’ˆä¼˜åŒ–ï¼‰</td></tr><tr><td><strong>èŠ‚ç‚¹å¤ç”¨</strong></td><td>ç±»å‹ç›¸åŒåˆ™å¤ç”¨ï¼Œå¦åˆ™é”€æ¯é‡å»º</td><td>ç±»å‹ç›¸åŒåˆ™å°è¯•å¤ç”¨ï¼Œä¼˜å…ˆç§»åŠ¨è€Œéé‡å»º</td></tr><tr><td><strong>é™æ€ä¼˜åŒ–</strong></td><td>éœ€æ‰‹åŠ¨ä¼˜åŒ–ï¼ˆå¦‚ <code>React.memo</code>ï¼‰</td><td>ç¼–è¯‘é˜¶æ®µè‡ªåŠ¨æ ‡è®°é™æ€èŠ‚ç‚¹</td></tr><tr><td><strong>æ›´æ–°ç²’åº¦</strong></td><td>ç»„ä»¶çº§æ›´æ–°ï¼ˆé»˜è®¤ï¼‰</td><td>ç»„ä»¶çº§ + å—çº§ï¼ˆVue3 Fragmentsï¼‰</td></tr></tbody></table><p><strong>2. åˆ—è¡¨ Diff å®ç°ç»†èŠ‚</strong></p><p><strong>a. React çš„ç´¢å¼•å¯¹æ¯”ç­–ç•¥</strong></p><ul><li><strong>æ—  key æ—¶</strong>ï¼šæŒ‰ç´¢å¼•é¡ºåºå¯¹æ¯”ï¼Œå¯èƒ½å¯¼è‡´æ— æ•ˆæ›´æ–°<div class="language-jsx vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">jsx</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// æ—§åˆ—è¡¨ï¼š[A, B, C]</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// æ–°åˆ—è¡¨ï¼š[D, A, B, C]ï¼ˆæ’å…¥å¤´éƒ¨ï¼‰</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// React å¯¹æ¯”ç»“æœï¼šæ›´æ–°ç´¢å¼• 0-3ï¼Œæ€§èƒ½ä½ä¸‹</span></span></code></pre></div></li><li><strong>æœ‰ key æ—¶</strong>ï¼šé€šè¿‡ key åŒ¹é…èŠ‚ç‚¹ï¼Œå‡å°‘ç§»åŠ¨æ“ä½œ<div class="language-jsx vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">jsx</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// key åŒ¹é…åï¼Œä»…æ’å…¥ Dï¼Œå…¶ä»–èŠ‚ç‚¹ä¸æ›´æ–°</span></span></code></pre></div></li></ul><p><strong>b. Vue çš„åŒç«¯å¯¹æ¯”ç­–ç•¥</strong></p><p>åˆ†å››æ­¥ä¼˜åŒ–å¯¹æ¯”æ•ˆç‡ï¼ˆVue2 æ ¸å¿ƒé€»è¾‘ï¼ŒVue3 ä¼˜åŒ–ä¸ºæœ€é•¿é€’å¢å­åºåˆ—ï¼‰ï¼š</p><ol><li><strong>å¤´å¤´å¯¹æ¯”</strong>ï¼šæ–°æ—§å¤´æŒ‡é’ˆèŠ‚ç‚¹ç›¸åŒåˆ™å¤ç”¨ï¼ŒæŒ‡é’ˆåç§»</li><li><strong>å°¾å°¾å¯¹æ¯”</strong>ï¼šæ–°æ—§å°¾æŒ‡é’ˆèŠ‚ç‚¹ç›¸åŒåˆ™å¤ç”¨ï¼ŒæŒ‡é’ˆå‰ç§»</li><li><strong>å¤´å°¾äº¤å‰å¯¹æ¯”</strong>ï¼šæ—§å¤´ vs æ–°å°¾ï¼Œæ—§å°¾ vs æ–°å¤´</li><li><strong>ä¸­é—´ä¹±åºå¯¹æ¯”</strong>ï¼šå»ºç«‹ key-index æ˜ å°„è¡¨ï¼Œå¤ç”¨å¯åŒ¹é…èŠ‚ç‚¹</li></ol><div class="language-js vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// æ—§åˆ—è¡¨ï¼š[A, B, C, D]</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// æ–°åˆ—è¡¨ï¼š[D, A, B, C]</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// Vue é€šè¿‡æ­¥éª¤3å¤´å°¾å¯¹æ¯”ï¼Œä»…ç§»åŠ¨ D åˆ°å¤´éƒ¨</span></span></code></pre></div><p><strong>3. é™æ€ä¼˜åŒ–æœºåˆ¶</strong></p><p><strong>a. Vue çš„ç¼–è¯‘æ—¶ä¼˜åŒ–</strong></p><ul><li><p><strong>é™æ€èŠ‚ç‚¹æ ‡è®°</strong>ï¼š æ¨¡æ¿ä¸­çš„é™æ€èŠ‚ç‚¹ï¼ˆæ— å“åº”å¼ç»‘å®šï¼‰ä¼šè¢«ç¼–è¯‘ä¸ºå¸¸é‡ï¼Œè·³è¿‡ Diff</p><div class="language-html vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">html</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">&lt;!-- ç¼–è¯‘å‰ --&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">div</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;Hello Vue&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">div</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">&lt;!-- ç¼–è¯‘å --&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">_hoisted_1 = createVNode(&quot;div&quot;, null, &quot;Hello Vue&quot;)</span></span></code></pre></div></li><li><p><strong>Block Treeï¼ˆVue3ï¼‰</strong>ï¼š åŠ¨æ€èŠ‚ç‚¹æŒ‰åŒºå—ï¼ˆBlockï¼‰ç»„ç»‡ï¼ŒDiff æ—¶ä»…å¯¹æ¯”åŠ¨æ€éƒ¨åˆ†</p></li></ul><p><strong>b. React çš„è¿è¡Œæ—¶ä¼˜åŒ–</strong></p><ul><li><strong>æ‰‹åŠ¨æ§åˆ¶æ›´æ–°</strong>ï¼š éœ€é€šè¿‡ <code>React.memo</code>ã€<code>shouldComponentUpdate</code> æˆ– <code>useMemo</code> é¿å…æ— æ•ˆæ¸²æŸ“<div class="language-jsx vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">jsx</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> MemoComp</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> React.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">memo</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(() </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">div</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;Static Content&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">div</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;)</span></span></code></pre></div></li></ul><p><strong>4. å“åº”å¼æ›´æ–°è§¦å‘</strong></p><table tabindex="0"><thead><tr><th><strong>æ¡†æ¶</strong></th><th><strong>æœºåˆ¶</strong></th><th><strong>Diff è§¦å‘æ¡ä»¶</strong></th></tr></thead><tbody><tr><td>React</td><td>çŠ¶æ€å˜åŒ–è§¦å‘ç»„ä»¶é‡æ–°æ¸²æŸ“</td><td>çˆ¶ç»„ä»¶æ¸²æŸ“ â†’ å­ç»„ä»¶é»˜è®¤é€’å½’ Diff</td></tr><tr><td>Vue</td><td>å“åº”å¼æ•°æ®å˜æ›´è§¦å‘ç»„ä»¶æ›´æ–°</td><td>ä¾èµ–æ”¶é›† â†’ ä»…å—å½±å“ç»„ä»¶è§¦å‘ Diff</td></tr></tbody></table><div class="language-javascript vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// Vueï¼šåªæœ‰ data.value å˜åŒ–æ‰ä¼šè§¦å‘æ›´æ–°</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> vm</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Vue</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">({ data: { value: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> } })</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// Reactï¼šéœ€æ˜¾å¼è°ƒç”¨ setState</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">value</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">setValue</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> useState</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p><strong>5. è®¾è®¡å“²å­¦å·®å¼‚</strong></p><table tabindex="0"><thead><tr><th><strong>ç»´åº¦</strong></th><th><strong>React</strong></th><th><strong>Vue</strong></th></tr></thead><tbody><tr><td><strong>æ§åˆ¶ç²’åº¦</strong></td><td>ç»„ä»¶çº§æ§åˆ¶ï¼ˆå¼€å‘è€…ä¸»å¯¼ï¼‰</td><td>ç»†ç²’åº¦ä¾èµ–è¿½è¸ªï¼ˆæ¡†æ¶ä¸»å¯¼ï¼‰</td></tr><tr><td><strong>ä¼˜åŒ–æ–¹å‘</strong></td><td>è¿è¡Œæ—¶ä¼˜åŒ–ï¼ˆFiber è°ƒåº¦ï¼‰</td><td>ç¼–è¯‘æ—¶ä¼˜åŒ–ï¼ˆæ¨¡æ¿é™æ€åˆ†æï¼‰</td></tr><tr><td><strong>é€‚ç”¨åœºæ™¯</strong></td><td>å¤§å‹åŠ¨æ€åº”ç”¨ï¼ˆéœ€ç²¾ç»†æ§åˆ¶ï¼‰</td><td>ä¸­å°å‹åº”ç”¨ï¼ˆå¿«é€Ÿå¼€å‘ï¼‰</td></tr></tbody></table></details><h2 id="react-jsx-å¾ªç¯ä¸ºä½•ä½¿ç”¨-key" tabindex="-1">React JSX å¾ªç¯ä¸ºä½•ä½¿ç”¨ <code>key</code> ï¼Ÿ <a class="header-anchor" href="#react-jsx-å¾ªç¯ä¸ºä½•ä½¿ç”¨-key" aria-label="Permalink to &quot;React JSX å¾ªç¯ä¸ºä½•ä½¿ç”¨ `key` ï¼Ÿ&quot;">â€‹</a></h2><p>å‚è€ƒç­”æ¡ˆ</p><details class="details custom-block"><summary>Details</summary><ol><li><strong>å…ƒç´ çš„é«˜æ•ˆè¯†åˆ«ä¸å¤ç”¨</strong></li></ol><p>React é€šè¿‡ <code>key</code> å”¯ä¸€æ ‡è¯†åˆ—è¡¨ä¸­çš„æ¯ä¸ªå…ƒç´ ã€‚å½“åˆ—è¡¨å‘ç”Ÿå˜åŒ–ï¼ˆå¢åˆ æ”¹æ’åºï¼‰æ—¶ï¼ŒReact ä¼šé€šè¿‡ <code>key</code> å¿«é€Ÿåˆ¤æ–­ï¼š</p><ul><li><strong>å“ªäº›å…ƒç´ æ˜¯æ–°å¢çš„</strong>ï¼ˆéœ€è¦åˆ›å»ºæ–° DOM èŠ‚ç‚¹ï¼‰</li><li><strong>å“ªäº›å…ƒç´ æ˜¯ç§»é™¤çš„</strong>ï¼ˆéœ€è¦é”€æ¯æ—§ DOM èŠ‚ç‚¹ï¼‰</li><li><strong>å“ªäº›å…ƒç´ æ˜¯ç§»åŠ¨çš„</strong>ï¼ˆç›´æ¥å¤ç”¨ç°æœ‰ DOM èŠ‚ç‚¹ï¼Œä»…è°ƒæ•´é¡ºåºï¼‰</li></ul><p>å¦‚æœæ²¡æœ‰ <code>key</code>ï¼ŒReact ä¼šé»˜è®¤ä½¿ç”¨æ•°ç»„ç´¢å¼•ï¼ˆ<code>index</code>ï¼‰ä½œä¸ºæ ‡è¯†ï¼Œè¿™åœ¨åŠ¨æ€åˆ—è¡¨ä¸­ä¼šå¯¼è‡´ <strong>æ€§èƒ½ä¸‹é™</strong> æˆ– <strong>çŠ¶æ€é”™è¯¯</strong>ã€‚</p><ol start="2"><li><strong>é¿å…çŠ¶æ€æ··ä¹±</strong></li></ol><p>å¦‚æœåˆ—è¡¨é¡¹æ˜¯ <strong>æœ‰çŠ¶æ€çš„ç»„ä»¶</strong>ï¼ˆæ¯”å¦‚è¾“å…¥æ¡†ã€å‹¾é€‰æ¡†ç­‰ï¼‰ï¼Œé”™è¯¯çš„ <code>key</code> ä¼šå¯¼è‡´çŠ¶æ€ä¸é”™è¯¯çš„å†…å®¹ç»‘å®šã€‚ä¾‹å¦‚ï¼š</p><div class="language-jsx vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">jsx</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// å¦‚æœåˆå§‹åˆ—è¡¨æ˜¯ [A, B]ï¼Œç”¨ç´¢å¼• index ä½œä¸º keyï¼š</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">ul</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  {items.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">map</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">((</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">item</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">index</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">li</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> key</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{index}&gt;{item}&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">li</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  ))}</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">ul</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// åœ¨å¤´éƒ¨æ’å…¥æ–°å…ƒç´ å˜ä¸º [C, A, B] æ—¶ï¼š</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// React ä¼šè®¤ä¸º key=0 â†’ Cï¼ˆé‡æ–°åˆ›å»ºï¼‰</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// key=1 â†’ Aï¼ˆå¤ç”¨åŸ key=0 çš„ DOMï¼Œä½†çŠ¶æ€å¯èƒ½æ®‹ç•™ï¼‰</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// æ­¤æ—¶ï¼ŒåŸæœ¬å±äº A çš„è¾“å…¥æ¡†çŠ¶æ€å¯èƒ½ä¼šé”™è¯¯åœ°å‡ºç°åœ¨ C ä¸­ã€‚</span></span></code></pre></div><ol start="3"><li><strong>æå‡æ¸²æŸ“æ€§èƒ½</strong></li></ol><p>é€šè¿‡å”¯ä¸€ä¸”ç¨³å®šçš„ <code>key</code>ï¼ˆå¦‚æ•°æ® IDï¼‰ï¼ŒReact å¯ä»¥ç²¾å‡†åˆ¤æ–­å¦‚ä½•å¤ç”¨ DOM èŠ‚ç‚¹ã€‚å¦‚æœä½¿ç”¨éšæœºæ•°æˆ–ç´¢å¼•ï¼Œæ¯æ¬¡æ¸²æŸ“éƒ½ä¼šå¼ºåˆ¶é‡æ–°åˆ›å»ºæ‰€æœ‰å…ƒç´ ï¼Œå¯¼è‡´æ€§èƒ½æµªè´¹ã€‚</p></details><h2 id="react-äº‹ä»¶å’Œ-dom-äº‹ä»¶åŒºåˆ«" tabindex="-1">React äº‹ä»¶å’Œ DOM äº‹ä»¶åŒºåˆ« <a class="header-anchor" href="#react-äº‹ä»¶å’Œ-dom-äº‹ä»¶åŒºåˆ«" aria-label="Permalink to &quot;React äº‹ä»¶å’Œ DOM äº‹ä»¶åŒºåˆ«&quot;">â€‹</a></h2><p>å‚è€ƒç­”æ¡ˆ</p><details class="details custom-block"><summary>Details</summary><ol><li><strong>äº‹ä»¶ç»‘å®šæ–¹å¼</strong></li></ol><ul><li><p><strong>React äº‹ä»¶</strong> ä½¿ç”¨<strong>é©¼å³°å‘½åæ³•</strong>ï¼ˆå¦‚ <code>onClick</code>ã€<code>onChange</code>ï¼‰ï¼Œé€šè¿‡ JSX å±æ€§ç›´æ¥ç»‘å®šå‡½æ•°ï¼š</p><div class="language-jsx vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">jsx</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">button</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> onClick</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{handleClick}&gt;ç‚¹å‡»&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">button</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span></code></pre></div></li><li><p><strong>DOM äº‹ä»¶</strong> ä½¿ç”¨<strong>å…¨å°å†™å‘½å</strong>ï¼ˆå¦‚ <code>onclick</code>ã€<code>onchange</code>ï¼‰ï¼Œé€šè¿‡å­—ç¬¦ä¸²æˆ– <code>addEventListener</code> ç»‘å®šï¼š</p><div class="language-html vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">html</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">button</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> onclick</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">handleClick</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">()&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;ç‚¹å‡»&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">button</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span></code></pre></div><div class="language-javascript vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">button.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">addEventListener</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;click&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, handleClick)</span></span></code></pre></div></li></ul><ol start="2"><li><strong>äº‹ä»¶å¯¹è±¡ï¼ˆEvent Objectï¼‰</strong></li></ol><ul><li><p><strong>React äº‹ä»¶</strong> ä½¿ç”¨<strong>åˆæˆäº‹ä»¶ï¼ˆSyntheticEventï¼‰</strong>ï¼Œæ˜¯åŸç”Ÿäº‹ä»¶å¯¹è±¡çš„è·¨æµè§ˆå™¨åŒ…è£…ã€‚</p><ul><li>é€šè¿‡ <code>e.nativeEvent</code> è®¿é—®åŸç”Ÿäº‹ä»¶ã€‚</li><li>äº‹ä»¶å¯¹è±¡ä¼šè¢«å¤ç”¨ï¼ˆäº‹ä»¶æ± æœºåˆ¶ï¼‰ï¼Œå¼‚æ­¥è®¿é—®éœ€è°ƒç”¨ <code>e.persist()</code>ã€‚</li></ul><div class="language-jsx vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">jsx</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> handleClick</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">e</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  e.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">persist</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">() </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// ä¿æŒäº‹ä»¶å¯¹è±¡å¼•ç”¨</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  setTimeout</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(() </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> console.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(e.target), </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">100</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div></li><li><p><strong>DOM äº‹ä»¶</strong> ç›´æ¥ä½¿ç”¨æµè§ˆå™¨åŸç”Ÿäº‹ä»¶å¯¹è±¡ï¼Œæ— å¤ç”¨æœºåˆ¶ã€‚</p><div class="language-javascript vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">button.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">addEventListener</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;click&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, (</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">e</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  console.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(e.target) </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// ç›´æ¥è®¿é—®</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">})</span></span></code></pre></div></li></ul><ol start="3"><li><strong>äº‹ä»¶ä¼ æ’­ä¸é»˜è®¤è¡Œä¸º</strong></li></ol><ul><li><p><strong>React äº‹ä»¶</strong></p><ul><li><strong>é˜»æ­¢é»˜è®¤è¡Œä¸º</strong>ï¼šå¿…é¡»æ˜¾å¼è°ƒç”¨ <code>e.preventDefault()</code>ã€‚</li><li><strong>é˜»æ­¢å†’æ³¡</strong>ï¼šè°ƒç”¨ <code>e.stopPropagation()</code>ã€‚</li></ul><div class="language-jsx vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">jsx</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> handleSubmit</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">e</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  e.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">preventDefault</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">() </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// é˜»æ­¢è¡¨å•é»˜è®¤æäº¤</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  e.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">stopPropagation</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">() </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// é˜»æ­¢äº‹ä»¶å†’æ³¡</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div></li><li><p><strong>DOM äº‹ä»¶</strong></p><ul><li><strong>é˜»æ­¢é»˜è®¤è¡Œä¸º</strong>ï¼šå¯è°ƒç”¨ <code>e.preventDefault()</code> æˆ– <code>return false</code>ï¼ˆåœ¨ HTML å±æ€§ä¸­ï¼‰ã€‚</li><li><strong>é˜»æ­¢å†’æ³¡</strong>ï¼šè°ƒç”¨ <code>e.stopPropagation()</code> æˆ– <code>return false</code>ï¼ˆä»…éƒ¨åˆ†æƒ…å†µï¼‰ã€‚</li></ul><div class="language-html vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">html</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">form</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> onsubmit</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">return</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> false</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  &lt;!-- é˜»æ­¢é»˜è®¤æäº¤ --&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">button</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> onclick</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">event</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">stopPropagation</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">()&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;æŒ‰é’®&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">button</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">form</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span></code></pre></div></li></ul><ol start="4"><li><strong>æ€§èƒ½ä¼˜åŒ–</strong></li></ol><ul><li><p><strong>React äº‹ä»¶</strong> é‡‡ç”¨<strong>äº‹ä»¶å§”æ‰˜</strong>æœºåˆ¶ï¼š</p><ul><li>React 17 ä¹‹å‰å°†äº‹ä»¶å§”æ‰˜åˆ° <code>document</code> å±‚çº§ã€‚</li><li>React 17+ æ”¹ä¸ºå§”æ‰˜åˆ°æ¸²æŸ“çš„æ ¹å®¹å™¨ï¼ˆå¦‚ <code>ReactDOM.render</code> æŒ‚è½½çš„èŠ‚ç‚¹ï¼‰ã€‚</li><li>å‡å°‘å†…å­˜å ç”¨ï¼ŒåŠ¨æ€æ·»åŠ å…ƒç´ æ— éœ€é‡æ–°ç»‘å®šäº‹ä»¶ã€‚</li></ul></li><li><p><strong>DOM äº‹ä»¶</strong> ç›´æ¥ç»‘å®šåˆ°å…ƒç´ ï¼Œå¤§é‡äº‹ä»¶ç›‘å¬æ—¶å¯èƒ½å¯¼è‡´æ€§èƒ½é—®é¢˜ã€‚</p></li></ul><ol start="5"><li><strong>è·¨æµè§ˆå™¨å…¼å®¹æ€§</strong></li></ol><ul><li><p><strong>React äº‹ä»¶</strong> åˆæˆäº‹ä»¶æŠ¹å¹³äº†æµè§ˆå™¨å·®å¼‚ï¼ˆå¦‚ <code>event.target</code> çš„ä¸€è‡´æ€§ï¼‰ï¼Œæ— éœ€å¤„ç†å…¼å®¹æ€§é—®é¢˜ã€‚</p></li><li><p><strong>DOM äº‹ä»¶</strong> éœ€æ‰‹åŠ¨å¤„ç†æµè§ˆå™¨å…¼å®¹æ€§ï¼ˆå¦‚ IE çš„ <code>attachEvent</code> vs æ ‡å‡† <code>addEventListener</code>ï¼‰ã€‚</p></li></ul><ol start="6"><li><strong><code>this</code> ç»‘å®š</strong></li></ol><ul><li><p><strong>React äº‹ä»¶</strong> ç±»ç»„ä»¶ä¸­éœ€æ‰‹åŠ¨ç»‘å®š <code>this</code> æˆ–ä½¿ç”¨ç®­å¤´å‡½æ•°ï¼š</p><div class="language-jsx vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">jsx</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">class</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> MyComponent</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> extends</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> React</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Component</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  handleClick</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">() {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    console.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">this</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// éœ€ç»‘å®šï¼Œå¦åˆ™ä¸º undefined</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  }</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  render</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">() {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">button</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> onClick</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">this</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.handleClick.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">bind</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">this</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)}&gt;ç‚¹å‡»&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">button</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div></li><li><p><strong>DOM äº‹ä»¶</strong> äº‹ä»¶å¤„ç†å‡½æ•°ä¸­çš„ <code>this</code> é»˜è®¤æŒ‡å‘è§¦å‘äº‹ä»¶çš„å…ƒç´ ï¼š</p><div class="language-javascript vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">button.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">addEventListener</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;click&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">function</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> () {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  console.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">this</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// æŒ‡å‘ button å…ƒç´ </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">})</span></span></code></pre></div></li></ul><table tabindex="0"><thead><tr><th>ç‰¹æ€§</th><th>React äº‹ä»¶</th><th>DOM äº‹ä»¶</th></tr></thead><tbody><tr><td><strong>å‘½åè§„åˆ™</strong></td><td>é©¼å³°å‘½åï¼ˆ<code>onClick</code>ï¼‰</td><td>å…¨å°å†™ï¼ˆ<code>onclick</code>ï¼‰</td></tr><tr><td><strong>äº‹ä»¶å¯¹è±¡</strong></td><td>åˆæˆäº‹ä»¶ï¼ˆ<code>SyntheticEvent</code>ï¼‰</td><td>åŸç”Ÿäº‹ä»¶å¯¹è±¡</td></tr><tr><td><strong>é»˜è®¤è¡Œä¸ºé˜»æ­¢</strong></td><td><code>e.preventDefault()</code></td><td><code>e.preventDefault()</code> æˆ– <code>return false</code></td></tr><tr><td><strong>äº‹ä»¶å§”æ‰˜</strong></td><td>è‡ªåŠ¨å§”æ‰˜åˆ°æ ¹å®¹å™¨</td><td>éœ€æ‰‹åŠ¨å®ç°</td></tr><tr><td><strong>è·¨æµè§ˆå™¨å…¼å®¹</strong></td><td>å†…ç½®å¤„ç†</td><td>éœ€æ‰‹åŠ¨é€‚é…</td></tr><tr><td><strong><code>this</code> æŒ‡å‘</strong></td><td>ç±»ç»„ä»¶ä¸­éœ€æ‰‹åŠ¨ç»‘å®š</td><td>é»˜è®¤æŒ‡å‘è§¦å‘å…ƒç´ </td></tr></tbody></table><p>React äº‹ä»¶ç³»ç»Ÿé€šè¿‡æŠ½è±¡å’Œä¼˜åŒ–ï¼Œæä¾›äº†æ›´é«˜æ•ˆã€ä¸€è‡´çš„äº‹ä»¶å¤„ç†æ–¹å¼ï¼Œé¿å…äº†ç›´æ¥æ“ä½œ DOM çš„ç¹çå’Œå…¼å®¹æ€§é—®é¢˜ã€‚</p></details><h2 id="ç®€è¿°-react-batchupdate-æœºåˆ¶" tabindex="-1">ç®€è¿° React batchUpdate æœºåˆ¶ <a class="header-anchor" href="#ç®€è¿°-react-batchupdate-æœºåˆ¶" aria-label="Permalink to &quot;ç®€è¿° React batchUpdate æœºåˆ¶&quot;">â€‹</a></h2><p>å‚è€ƒç­”æ¡ˆ</p><details class="details custom-block"><summary>Details</summary><p>React çš„ <strong>batchUpdateï¼ˆæ‰¹å¤„ç†æ›´æ–°ï¼‰æœºåˆ¶</strong> æ˜¯ä¸€ç§ä¼˜åŒ–ç­–ç•¥ï¼Œæ—¨åœ¨å°†å¤šä¸ªçŠ¶æ€æ›´æ–°åˆå¹¶ä¸ºä¸€æ¬¡æ¸²æŸ“ï¼Œå‡å°‘ä¸å¿…è¦çš„ç»„ä»¶é‡æ–°æ¸²æŸ“æ¬¡æ•°ï¼Œä»è€Œæé«˜æ€§èƒ½ã€‚</p><p><strong>æ ¸å¿ƒæœºåˆ¶</strong></p><ol><li><p><strong>å¼‚æ­¥åˆå¹¶æ›´æ–°</strong> å½“åœ¨ <strong>åŒä¸€æ‰§è¡Œä¸Šä¸‹æ–‡</strong>ï¼ˆå¦‚åŒä¸€ä¸ªäº‹ä»¶å¤„ç†å‡½æ•°ã€ç”Ÿå‘½å‘¨æœŸæ–¹æ³•æˆ– React åˆæˆäº‹ä»¶ï¼‰ä¸­å¤šæ¬¡è°ƒç”¨çŠ¶æ€æ›´æ–°ï¼ˆå¦‚ <code>setState</code>ã€<code>useState</code> çš„ <code>setter</code> å‡½æ•°ï¼‰ï¼ŒReact ä¸ä¼šç«‹å³è§¦å‘æ¸²æŸ“ï¼Œè€Œæ˜¯å°†å¤šä¸ªæ›´æ–°æ”¶é›†åˆ°ä¸€ä¸ªé˜Ÿåˆ—ä¸­ï¼Œæœ€ç»ˆåˆå¹¶ä¸ºä¸€æ¬¡æ›´æ–°ï¼Œç»Ÿä¸€è®¡ç®—æ–°çŠ¶æ€å¹¶æ¸²æŸ“ã€‚</p></li><li><p><strong>æ›´æ–°é˜Ÿåˆ—</strong> React å†…éƒ¨ç»´æŠ¤ä¸€ä¸ªæ›´æ–°é˜Ÿåˆ—ã€‚åœ¨è§¦å‘æ›´æ–°çš„ä»£ç å—ä¸­ï¼Œæ‰€æœ‰çŠ¶æ€å˜æ›´ä¼šè¢«æš‚å­˜åˆ°é˜Ÿåˆ—ï¼Œç›´åˆ°ä»£ç æ‰§è¡Œå®Œæ¯•ï¼ŒReact æ‰ä¼šä¸€æ¬¡æ€§å¤„ç†é˜Ÿåˆ—ä¸­çš„æ‰€æœ‰æ›´æ–°ï¼Œç”Ÿæˆæ–°çš„è™šæ‹Ÿ DOMï¼Œå¹¶é€šè¿‡ Diff ç®—æ³•é«˜æ•ˆæ›´æ–°çœŸå® DOMã€‚</p></li></ol><p><strong>è§¦å‘æ‰¹å¤„ç†çš„åœºæ™¯</strong></p><ol><li><p><strong>React åˆæˆäº‹ä»¶</strong> å¦‚ <code>onClick</code>ã€<code>onChange</code> ç­‰äº‹ä»¶å¤„ç†å‡½æ•°ä¸­çš„å¤šæ¬¡çŠ¶æ€æ›´æ–°ä¼šè‡ªåŠ¨æ‰¹å¤„ç†ã€‚</p><div class="language-jsx vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">jsx</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> handleClick</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> () </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  setCount</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// æ›´æ–°å…¥é˜Ÿ</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  setName</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;Alice&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// æ›´æ–°å…¥é˜Ÿ</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  // æœ€ç»ˆåˆå¹¶ä¸ºä¸€æ¬¡æ¸²æŸ“</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div></li><li><p><strong>React ç”Ÿå‘½å‘¨æœŸå‡½æ•°</strong> åœ¨ <code>componentDidMount</code>ã€<code>componentDidUpdate</code> ç­‰ç”Ÿå‘½å‘¨æœŸæ–¹æ³•ä¸­çš„æ›´æ–°ä¼šè¢«æ‰¹å¤„ç†ã€‚</p></li><li><p><strong>React 18+ çš„è‡ªåŠ¨æ‰¹å¤„ç†å¢å¼º</strong> React 18 å¼•å…¥ <code>createRoot</code> åï¼Œå³ä½¿åœ¨å¼‚æ­¥æ“ä½œï¼ˆå¦‚ <code>setTimeout</code>ã€<code>Promise</code>ã€åŸç”Ÿäº‹ä»¶å›è°ƒï¼‰ä¸­çš„æ›´æ–°ä¹Ÿä¼šè‡ªåŠ¨æ‰¹å¤„ç†ï¼š</p><div class="language-jsx vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">jsx</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">setTimeout</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(() </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  setCount</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// React 18 ä¸­è‡ªåŠ¨æ‰¹å¤„ç†</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  setName</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;Alice&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// åˆå¹¶ä¸ºä¸€æ¬¡æ¸²æŸ“</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1000</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div></li></ol><p><strong>ç»•è¿‡æ‰¹å¤„ç†çš„åœºæ™¯</strong></p><ol><li><p><strong>React 17 åŠä¹‹å‰çš„å¼‚æ­¥ä»£ç </strong> åœ¨ <code>setTimeout</code>ã€<code>Promise</code> æˆ–åŸç”Ÿäº‹ä»¶å›è°ƒä¸­çš„æ›´æ–°é»˜è®¤<strong>ä¸ä¼š</strong>æ‰¹å¤„ç†ï¼Œæ¯æ¬¡ <code>setState</code> è§¦å‘ä¸€æ¬¡æ¸²æŸ“ï¼š</p><div class="language-jsx vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">jsx</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// React 17 ä¸­ä¼šè§¦å‘ä¸¤æ¬¡æ¸²æŸ“</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">setTimeout</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(() </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  setCount</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// æ¸²æŸ“ä¸€æ¬¡</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  setName</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;Alice&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// æ¸²æŸ“ç¬¬äºŒæ¬¡</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1000</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div></li><li><p><strong>æ‰‹åŠ¨å¼ºåˆ¶åŒæ­¥æ›´æ–°</strong> ä½¿ç”¨ <code>flushSync</code>ï¼ˆReact 18+ï¼‰å¯å¼ºåˆ¶ç«‹å³æ›´æ–°ï¼Œç»•è¿‡æ‰¹å¤„ç†ï¼š</p><div class="language-jsx vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">jsx</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { flushSync } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;react-dom&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">flushSync</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(() </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  setCount</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// ç«‹å³æ¸²æŸ“</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">})</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">setName</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;Alice&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// å†æ¬¡æ¸²æŸ“</span></span></code></pre></div></li></ol><p><strong>è®¾è®¡ç›®çš„</strong></p><ol><li><p><strong>æ€§èƒ½ä¼˜åŒ–</strong> é¿å…é¢‘ç¹çš„ DOM æ“ä½œï¼Œå‡å°‘æµè§ˆå™¨é‡ç»˜å’Œå›æµï¼Œæå‡åº”ç”¨æ€§èƒ½ã€‚</p></li><li><p><strong>çŠ¶æ€ä¸€è‡´æ€§</strong> ç¡®ä¿åœ¨åŒä¸€ä¸ªä¸Šä¸‹æ–‡ä¸­å¤šæ¬¡çŠ¶æ€å˜æ›´åï¼Œç»„ä»¶æœ€ç»ˆåŸºäºæœ€æ–°çš„çŠ¶æ€å€¼æ¸²æŸ“ï¼Œé¿å…ä¸­é—´çŠ¶æ€å¯¼è‡´çš„ UI ä¸ä¸€è‡´ã€‚</p></li></ol><p><strong>ç¤ºä¾‹å¯¹æ¯”</strong></p><ul><li><p><strong>è‡ªåŠ¨æ‰¹å¤„ç†ï¼ˆReact 18+ï¼‰</strong></p><div class="language-jsx vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">jsx</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> handleClick</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> () </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  setCount</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">((</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">prev</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> prev </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">+</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// æ›´æ–°å…¥é˜Ÿ</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  setCount</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">((</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">prev</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> prev </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">+</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// æ›´æ–°å…¥é˜Ÿ</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  // æœ€ç»ˆ count å¢åŠ  2ï¼Œä»…ä¸€æ¬¡æ¸²æŸ“</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div></li><li><p><strong>éæ‰¹å¤„ç†ï¼ˆReact 17 å¼‚æ­¥ä»£ç ï¼‰</strong></p><div class="language-jsx vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">jsx</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">setTimeout</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(() </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  setCount</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">((</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">prev</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> prev </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">+</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// æ¸²æŸ“ä¸€æ¬¡</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  setCount</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">((</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">prev</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> prev </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">+</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// å†æ¸²æŸ“ä¸€æ¬¡</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  // React 17 ä¸­è§¦å‘ä¸¤æ¬¡æ¸²æŸ“ï¼Œcount ä»ä¸º 2</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1000</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div></li></ul><table tabindex="0"><thead><tr><th>åœºæ™¯</th><th>React 17 åŠä¹‹å‰</th><th>React 18+ï¼ˆä½¿ç”¨ <code>createRoot</code>ï¼‰</th></tr></thead><tbody><tr><td><strong>åˆæˆäº‹ä»¶/ç”Ÿå‘½å‘¨æœŸ</strong></td><td>è‡ªåŠ¨æ‰¹å¤„ç†</td><td>è‡ªåŠ¨æ‰¹å¤„ç†</td></tr><tr><td><strong>å¼‚æ­¥æ“ä½œ</strong></td><td>ä¸æ‰¹å¤„ç†</td><td>è‡ªåŠ¨æ‰¹å¤„ç†</td></tr><tr><td><strong>åŸç”Ÿäº‹ä»¶å›è°ƒ</strong></td><td>ä¸æ‰¹å¤„ç†</td><td>è‡ªåŠ¨æ‰¹å¤„ç†</td></tr></tbody></table><p>React çš„æ‰¹å¤„ç†æœºåˆ¶é€šè¿‡åˆå¹¶æ›´æ–°å‡å°‘äº†æ¸²æŸ“æ¬¡æ•°ï¼Œä½†åœ¨éœ€è¦å³æ—¶åé¦ˆçš„åœºæ™¯ï¼ˆå¦‚åŠ¨ç”»ï¼‰ä¸­ï¼Œå¯é€šè¿‡ <code>flushSync</code> å¼ºåˆ¶åŒæ­¥æ›´æ–°ã€‚</p></details><h2 id="ç®€è¿°-react-äº‹åŠ¡æœºåˆ¶" tabindex="-1">ç®€è¿° React äº‹åŠ¡æœºåˆ¶ <a class="header-anchor" href="#ç®€è¿°-react-äº‹åŠ¡æœºåˆ¶" aria-label="Permalink to &quot;ç®€è¿° React äº‹åŠ¡æœºåˆ¶&quot;">â€‹</a></h2><p>å‚è€ƒç­”æ¡ˆ</p><details class="details custom-block"><summary>Details</summary><p>React çš„ <strong>äº‹åŠ¡æœºåˆ¶ï¼ˆTransactionï¼‰</strong> æ˜¯æ—©æœŸç‰ˆæœ¬ï¼ˆReact 16 ä¹‹å‰ï¼‰ä¸­ç”¨äº <strong>æ‰¹é‡å¤„ç†æ›´æ–°</strong> å’Œ <strong>ç®¡ç†å‰¯ä½œç”¨</strong> çš„æ ¸å¿ƒè®¾è®¡æ¨¡å¼ï¼Œå…¶æ ¸å¿ƒæ€æƒ³æ˜¯é€šè¿‡â€œåŒ…è£…â€æ“ä½œæµç¨‹ï¼Œç¡®ä¿åœ¨æ›´æ–°è¿‡ç¨‹ä¸­æ‰§è¡Œç‰¹å®šçš„å‰ç½®å’Œåç½®é€»è¾‘ï¼ˆå¦‚ç”Ÿå‘½å‘¨æœŸé’©å­ã€äº‹ä»¶ç›‘å¬ç­‰ï¼‰ã€‚éšç€ React Fiber æ¶æ„çš„å¼•å…¥ï¼Œäº‹åŠ¡æœºåˆ¶é€æ¸è¢«æ›´çµæ´»çš„è°ƒåº¦ç³»ç»Ÿå–ä»£ã€‚</p><p><strong>æ ¸å¿ƒæ¦‚å¿µ</strong></p><ol><li><p><strong>äº‹åŠ¡çš„å®šä¹‰</strong> äº‹åŠ¡æ˜¯ä¸€ä¸ªåŒ…å« <strong>åˆå§‹åŒ–é˜¶æ®µ</strong>ã€<strong>æ‰§è¡Œé˜¶æ®µ</strong> å’Œ <strong>æ”¶å°¾é˜¶æ®µ</strong> çš„æµç¨‹æ§åˆ¶å•å…ƒã€‚æ¯ä¸ªäº‹åŠ¡é€šè¿‡ <code>Transaction</code> ç±»å®ç°ï¼Œæä¾› <code>initialize</code> å’Œ <code>close</code> æ–¹æ³•ï¼Œç”¨äºåœ¨æ“ä½œå‰åæ’å…¥é€»è¾‘ã€‚ä¾‹å¦‚ï¼š</p><div class="language-javascript vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> MyTransaction</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  initialize</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">() {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    /* å‰ç½®æ“ä½œï¼ˆå¦‚è®°å½•çŠ¶æ€ï¼‰ */</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  },</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  close</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">() {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    /* åç½®æ“ä½œï¼ˆå¦‚è§¦å‘æ›´æ–°ï¼‰ */</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  },</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div></li><li><p><strong>åŒ…è£…å‡½æ•°</strong> äº‹åŠ¡é€šè¿‡ <code>perform</code> æ–¹æ³•æ‰§è¡Œç›®æ ‡å‡½æ•°ï¼Œå°†å…¶åŒ…è£¹åœ¨äº‹åŠ¡çš„ç”Ÿå‘½å‘¨æœŸä¸­ï¼š</p><div class="language-javascript vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> myAction</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">() {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  /* æ ¸å¿ƒé€»è¾‘ï¼ˆå¦‚è°ƒç”¨ setStateï¼‰ */</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">MyTransaction.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">perform</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(myAction)</span></span></code></pre></div></li></ol><p><strong>åœ¨ React ä¸­çš„åº”ç”¨åœºæ™¯</strong></p><ol><li><p><strong>æ‰¹é‡æ›´æ–°ï¼ˆBatching Updatesï¼‰</strong> åœ¨äº‹ä»¶å¤„ç†æˆ–ç”Ÿå‘½å‘¨æœŸæ–¹æ³•ä¸­ï¼Œå¤šæ¬¡è°ƒç”¨ <code>setState</code> ä¼šè¢«äº‹åŠ¡åˆå¹¶ä¸ºä¸€æ¬¡æ›´æ–°ã€‚ä¾‹å¦‚ï¼š</p><div class="language-javascript vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">class</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Component</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  onClick</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">() {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    // äº‹åŠ¡åŒ…è£¹ä¸‹çš„å¤šæ¬¡ setState åˆå¹¶ä¸ºä¸€æ¬¡æ¸²æŸ“</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    this</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">setState</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">({ a: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> })</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    this</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">setState</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">({ b: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> })</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div></li><li><p><strong>ç”Ÿå‘½å‘¨æœŸé’©å­çš„è§¦å‘</strong> åœ¨ç»„ä»¶æŒ‚è½½æˆ–æ›´æ–°æ—¶ï¼Œäº‹åŠ¡ç¡®ä¿ <code>componentWillMount</code>ã€<code>componentDidMount</code> ç­‰é’©å­åœ¨æ­£ç¡®æ—¶æœºæ‰§è¡Œã€‚</p></li><li><p><strong>äº‹ä»¶ç³»ç»Ÿçš„å§”æ‰˜</strong> åˆæˆäº‹ä»¶ï¼ˆå¦‚ <code>onClick</code>ï¼‰çš„å¤„ç†é€»è¾‘é€šè¿‡äº‹åŠ¡ç»‘å®šå’Œè§£ç»‘ï¼Œç¡®ä¿äº‹ä»¶ç›‘å¬çš„ä¸€è‡´æ€§å’Œæ€§èƒ½ä¼˜åŒ–ã€‚</p></li></ol><p><strong>äº‹åŠ¡çš„å·¥ä½œæµç¨‹</strong></p><ol><li><strong>åˆå§‹åŒ–é˜¶æ®µ</strong> æ‰§è¡Œæ‰€æœ‰äº‹åŠ¡çš„ <code>initialize</code> æ–¹æ³•ï¼ˆå¦‚è®°å½•å½“å‰ DOM çŠ¶æ€ã€é”å®šäº‹ä»¶ç›‘å¬ï¼‰ã€‚</li><li><strong>æ‰§è¡Œç›®æ ‡å‡½æ•°</strong> è¿è¡Œæ ¸å¿ƒé€»è¾‘ï¼ˆå¦‚ç”¨æˆ·å®šä¹‰çš„ <code>setState</code> æˆ–äº‹ä»¶å¤„ç†å‡½æ•°ï¼‰ã€‚</li><li><strong>æ”¶å°¾é˜¶æ®µ</strong> æ‰§è¡Œæ‰€æœ‰äº‹åŠ¡çš„ <code>close</code> æ–¹æ³•ï¼ˆå¦‚å¯¹æ¯” DOM å˜åŒ–ã€è§¦å‘æ›´æ–°ã€è§£é”äº‹ä»¶ï¼‰ã€‚</li></ol><p><strong>äº‹åŠ¡æœºåˆ¶çš„å±€é™æ€§</strong></p><ol><li><strong>åŒæ­¥é˜»å¡</strong> äº‹åŠ¡çš„æ‰§è¡Œæ˜¯åŒæ­¥ä¸”ä¸å¯ä¸­æ–­çš„ï¼Œæ— æ³•æ”¯æŒå¼‚æ­¥ä¼˜å…ˆçº§è°ƒåº¦ï¼ˆå¦‚ Concurrent Mode çš„æ—¶é—´åˆ‡ç‰‡ï¼‰ã€‚</li><li><strong>å¤æ‚æ€§é«˜</strong> äº‹åŠ¡çš„åµŒå¥—å’Œç»„åˆé€»è¾‘å¤æ‚ï¼Œéš¾ä»¥ç»´æŠ¤å’Œæ‰©å±•ã€‚</li></ol><p><strong>Fiber æ¶æ„çš„æ¼”è¿›</strong> React 16 å¼•å…¥çš„ <strong>Fiber æ¶æ„</strong> æ›¿ä»£äº†äº‹åŠ¡æœºåˆ¶ï¼Œæ ¸å¿ƒæ”¹è¿›åŒ…æ‹¬ï¼š</p><ol><li><strong>å¼‚æ­¥å¯ä¸­æ–­æ›´æ–°</strong> é€šè¿‡ Fiber èŠ‚ç‚¹çš„é“¾è¡¨ç»“æ„ï¼Œæ”¯æŒæš‚åœã€æ¢å¤å’Œä¼˜å…ˆçº§è°ƒåº¦ã€‚</li><li><strong>æ›´ç»†ç²’åº¦çš„æ§åˆ¶</strong> å°†æ¸²æŸ“æ‹†åˆ†ä¸ºå¤šä¸ªé˜¶æ®µï¼ˆå¦‚ <code>render</code> å’Œ <code>commit</code>ï¼‰ï¼Œå‰¯ä½œç”¨ç®¡ç†æ›´çµæ´»ã€‚</li><li><strong>æ›¿ä»£æ‰¹é‡æ›´æ–°ç­–ç•¥</strong> ä½¿ç”¨è°ƒåº¦å™¨ï¼ˆSchedulerï¼‰å’Œä¼˜å…ˆçº§é˜Ÿåˆ—å®ç°æ›´é«˜æ•ˆçš„æ‰¹å¤„ç†ï¼ˆå¦‚ React 18 çš„è‡ªåŠ¨æ‰¹å¤„ç†ï¼‰ã€‚</li></ol><table tabindex="0"><thead><tr><th>ç‰¹æ€§</th><th>äº‹åŠ¡æœºåˆ¶ï¼ˆReact &lt;16ï¼‰</th><th>Fiber æ¶æ„ï¼ˆReact 16+ï¼‰</th></tr></thead><tbody><tr><td><strong>æ›´æ–°æ–¹å¼</strong></td><td>åŒæ­¥æ‰¹é‡æ›´æ–°</td><td>å¼‚æ­¥å¯ä¸­æ–­ã€ä¼˜å…ˆçº§è°ƒåº¦</td></tr><tr><td><strong>å‰¯ä½œç”¨ç®¡ç†</strong></td><td>é€šè¿‡äº‹åŠ¡ç”Ÿå‘½å‘¨æœŸæ§åˆ¶</td><td>é€šè¿‡ Effect Hookã€æäº¤é˜¶æ®µå¤„ç†</td></tr><tr><td><strong>å¤æ‚åº¦</strong></td><td>é«˜ï¼ˆåµŒå¥—äº‹åŠ¡é€»è¾‘å¤æ‚ï¼‰</td><td>é«˜ï¼ˆä½†æ›´æ¨¡å—åŒ–å’Œå¯æ‰©å±•ï¼‰</td></tr><tr><td><strong>é€‚ç”¨åœºæ™¯</strong></td><td>ç®€å•åŒæ­¥æ›´æ–°</td><td>å¤æ‚å¼‚æ­¥æ¸²æŸ“ï¼ˆå¦‚åŠ¨ç”»ã€æ‡’åŠ è½½ï¼‰</td></tr></tbody></table><p>äº‹åŠ¡æœºåˆ¶æ˜¯ React æ—©æœŸå®ç°æ‰¹é‡æ›´æ–°çš„åŸºçŸ³ï¼Œä½†å…¶åŒæ­¥è®¾è®¡æ— æ³•æ»¡è¶³ç°ä»£å‰ç«¯åº”ç”¨çš„å¤æ‚éœ€æ±‚ã€‚Fiber æ¶æ„é€šè¿‡è§£è€¦æ¸²æŸ“è¿‡ç¨‹ï¼Œä¸º Concurrent Mode å’Œ Suspense ç­‰ç‰¹æ€§å¥ å®šäº†åŸºç¡€ï¼Œæˆä¸º React é«˜æ•ˆæ¸²æŸ“çš„æ ¸å¿ƒã€‚</p></details><h2 id="ç†è§£-react-concurrency-å¹¶å‘æœºåˆ¶" tabindex="-1">ç†è§£ React concurrency å¹¶å‘æœºåˆ¶ <a class="header-anchor" href="#ç†è§£-react-concurrency-å¹¶å‘æœºåˆ¶" aria-label="Permalink to &quot;ç†è§£ React concurrency å¹¶å‘æœºåˆ¶&quot;">â€‹</a></h2><p>å‚è€ƒç­”æ¡ˆ</p><details class="details custom-block"><summary>Details</summary><p>React çš„å¹¶å‘æœºåˆ¶ï¼ˆConcurrencyï¼‰æ˜¯ React 18 å¼•å…¥çš„ä¸€é¡¹é‡è¦ç‰¹æ€§ï¼Œæ—¨åœ¨æå‡åº”ç”¨çš„å“åº”æ€§å’Œæ€§èƒ½ã€‚</p><p><strong>1. ä»€ä¹ˆæ˜¯ React çš„å¹¶å‘æœºåˆ¶ï¼Ÿ</strong></p><p>React çš„å¹¶å‘æœºåˆ¶å…è®¸ React åœ¨æ¸²æŸ“è¿‡ç¨‹ä¸­æ ¹æ®ä»»åŠ¡çš„ä¼˜å…ˆçº§è¿›è¡Œè°ƒåº¦å’Œä¸­æ–­ï¼Œä»è€Œç¡®ä¿é«˜ä¼˜å…ˆçº§çš„æ›´æ–°èƒ½å¤ŸåŠæ—¶æ¸²æŸ“ï¼Œè€Œä¸ä¼šè¢«ä½ä¼˜å…ˆçº§çš„ä»»åŠ¡é˜»å¡ã€‚</p><p><strong>2. å¹¶å‘æœºåˆ¶çš„å·¥ä½œåŸç†ï¼š</strong></p><ul><li><p><strong>æ—¶é—´åˆ†ç‰‡ï¼ˆTime Slicingï¼‰ï¼š</strong> React å°†æ¸²æŸ“ä»»åŠ¡æ‹†åˆ†ä¸ºå¤šä¸ªå°ç‰‡æ®µï¼Œæ¯ä¸ªç‰‡æ®µåœ¨ä¸»çº¿ç¨‹ç©ºé—²æ—¶æ‰§è¡Œã€‚è¿™ä½¿å¾—æµè§ˆå™¨å¯ä»¥åœ¨æ¸²æŸ“è¿‡ç¨‹ä¸­å¤„ç†ç”¨æˆ·è¾“å…¥å’Œå…¶ä»–é«˜ä¼˜å…ˆçº§ä»»åŠ¡ï¼Œé¿å…é•¿æ—¶é—´çš„æ¸²æŸ“é˜»å¡ç”¨æˆ·äº¤äº’ã€‚</p></li><li><p><strong>ä¼˜å…ˆçº§è°ƒåº¦ï¼ˆPriority Schedulingï¼‰ï¼š</strong> React ä¸ºä¸åŒçš„æ›´æ–°åˆ†é…ä¸åŒçš„ä¼˜å…ˆçº§ã€‚é«˜ä¼˜å…ˆçº§çš„æ›´æ–°ï¼ˆå¦‚ç”¨æˆ·è¾“å…¥ï¼‰ä¼šè¢«ä¼˜å…ˆå¤„ç†ï¼Œè€Œä½ä¼˜å…ˆçº§çš„æ›´æ–°ï¼ˆå¦‚æ•°æ®é¢„åŠ è½½ï¼‰å¯ä»¥åœ¨ç©ºé—²æ—¶å¤„ç†ã€‚</p></li><li><p><strong>å¯ä¸­æ–­æ¸²æŸ“ï¼ˆInterruptible Renderingï¼‰ï¼š</strong> åœ¨å¹¶å‘æ¨¡å¼ä¸‹ï¼ŒReact å¯ä»¥ä¸­æ–­å½“å‰çš„æ¸²æŸ“ä»»åŠ¡ï¼Œå¤„ç†æ›´é«˜ä¼˜å…ˆçº§çš„ä»»åŠ¡ï¼Œç„¶åå†æ¢å¤ä¹‹å‰çš„æ¸²æŸ“ã€‚è¿™ç¡®ä¿äº†åº”ç”¨åœ¨é•¿æ—¶é—´æ¸²æŸ“è¿‡ç¨‹ä¸­ä»èƒ½ä¿æŒå“åº”æ€§ã€‚</p></li></ul><p><strong>3. å¹¶å‘æœºåˆ¶çš„ä¼˜åŠ¿ï¼š</strong></p><ul><li><p><strong>æå‡å“åº”æ€§ï¼š</strong> é€šè¿‡ä¼˜å…ˆå¤„ç†é«˜ä¼˜å…ˆçº§ä»»åŠ¡ï¼ŒReact èƒ½å¤Ÿæ›´å¿«åœ°å“åº”ç”¨æˆ·è¾“å…¥ï¼Œæå‡ç”¨æˆ·ä½“éªŒã€‚</p></li><li><p><strong>ä¼˜åŒ–æ€§èƒ½ï¼š</strong> å°†æ¸²æŸ“ä»»åŠ¡æ‹†åˆ†ä¸ºå°ç‰‡æ®µï¼Œé¿å…é•¿æ—¶é—´çš„æ¸²æŸ“é˜»å¡ï¼Œæå‡åº”ç”¨çš„æ•´ä½“æ€§èƒ½ã€‚</p></li><li><p><strong>æ›´å¥½çš„èµ„æºåˆ©ç”¨ï¼š</strong> åœ¨ä¸»çº¿ç¨‹ç©ºé—²æ—¶å¤„ç†ä½ä¼˜å…ˆçº§ä»»åŠ¡ï¼Œå……åˆ†åˆ©ç”¨ç³»ç»Ÿèµ„æºã€‚</p></li></ul><p><strong>4. å¦‚ä½•å¯ç”¨å¹¶å‘æ¨¡å¼ï¼š</strong></p><p>è¦åœ¨ React åº”ç”¨ä¸­å¯ç”¨å¹¶å‘æ¨¡å¼ï¼Œéœ€è¦ä½¿ç”¨ <code>createRoot</code> APIï¼š</p><div class="language-javascript vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> React </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;react&#39;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ReactDOM </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;react-dom/client&#39;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> App </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;./App&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> root</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ReactDOM.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">createRoot</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(document.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">getElementById</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;root&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">))</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">root.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">render</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(&lt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">App</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> /&gt;)</span></span></code></pre></div><p>åœ¨å¹¶å‘æ¨¡å¼ä¸‹ï¼ŒReact ä¼šè‡ªåŠ¨æ ¹æ®ä»»åŠ¡çš„ä¼˜å…ˆçº§è¿›è¡Œè°ƒåº¦å’Œæ¸²æŸ“ã€‚</p></details><h2 id="react-reconciliation-åè°ƒçš„è¿‡ç¨‹" tabindex="-1">React reconciliation åè°ƒçš„è¿‡ç¨‹ <a class="header-anchor" href="#react-reconciliation-åè°ƒçš„è¿‡ç¨‹" aria-label="Permalink to &quot;React reconciliation åè°ƒçš„è¿‡ç¨‹&quot;">â€‹</a></h2><p>å‚è€ƒç­”æ¡ˆ</p><details class="details custom-block"><summary>Details</summary><p>React çš„ <strong>åè°ƒï¼ˆReconciliationï¼‰</strong> æ˜¯ç”¨äºé«˜æ•ˆæ›´æ–° UI çš„æ ¸å¿ƒç®—æ³•ã€‚å½“ç»„ä»¶çŠ¶æ€æˆ–å±æ€§å˜åŒ–æ—¶ï¼ŒReact ä¼šé€šè¿‡å¯¹æ¯”æ–°æ—§è™šæ‹Ÿ DOMï¼ˆVirtual DOMï¼‰æ ‘ï¼Œæ‰¾å‡ºæœ€å°åŒ–çš„å·®å¼‚å¹¶åº”ç”¨æ›´æ–°ã€‚ä»¥ä¸‹æ˜¯åè°ƒè¿‡ç¨‹çš„è¯¦ç»†æ­¥éª¤ï¼š</p><ol><li><strong>ç”Ÿæˆè™šæ‹Ÿ DOM æ ‘</strong></li></ol><ul><li>å½“ç»„ä»¶çŠ¶æ€æˆ–å±æ€§å˜åŒ–æ—¶ï¼ŒReact ä¼šé‡æ–°è°ƒç”¨ç»„ä»¶çš„ <code>render</code> æ–¹æ³•ï¼Œç”Ÿæˆæ–°çš„<strong>è™šæ‹Ÿ DOM æ ‘</strong>ï¼ˆä¸€ä¸ªè½»é‡çº§çš„ JavaScript å¯¹è±¡ï¼Œæè¿° UI ç»“æ„ï¼‰ã€‚</li><li>è™šæ‹Ÿ DOM æ˜¯å®é™… DOM çš„æŠ½è±¡è¡¨ç¤ºï¼Œæ“ä½œæˆæœ¬è¿œä½äºç›´æ¥æ“ä½œçœŸå® DOMã€‚</li></ul><ol start="2"><li><strong>Diffing ç®—æ³•ï¼ˆå·®å¼‚å¯¹æ¯”ï¼‰</strong> React ä½¿ç”¨ <strong>Diffing ç®—æ³•</strong> æ¯”è¾ƒæ–°æ—§ä¸¤æ£µè™šæ‹Ÿ DOM æ ‘ï¼Œæ‰¾å‡ºéœ€è¦æ›´æ–°çš„éƒ¨åˆ†ã€‚å¯¹æ¯”è§„åˆ™å¦‚ä¸‹ï¼š</li></ol><p><strong>è§„åˆ™ä¸€ï¼šä¸åŒç±»å‹çš„å…ƒç´ </strong></p><ul><li>å¦‚æœæ–°æ—§å…ƒç´ çš„ <code>type</code> ä¸åŒï¼ˆä¾‹å¦‚ä» <code>&lt;div&gt;</code> å˜ä¸º <code>&lt;span&gt;</code>ï¼‰ï¼ŒReact ä¼š<strong>é”€æ¯æ—§å­æ ‘</strong>ï¼Œ<strong>é‡å»ºæ–°å­æ ‘</strong>ã€‚ <ul><li>æ—§ç»„ä»¶çš„ç”Ÿå‘½å‘¨æœŸæ–¹æ³•ï¼ˆå¦‚ <code>componentWillUnmount</code>ï¼‰ä¼šè¢«è§¦å‘ã€‚</li><li>æ–°ç»„ä»¶çš„ç”Ÿå‘½å‘¨æœŸæ–¹æ³•ï¼ˆå¦‚ <code>constructor</code>ã€<code>componentDidMount</code>ï¼‰ä¼šè¢«è§¦å‘ã€‚</li></ul></li></ul><p><strong>è§„åˆ™äºŒï¼šç›¸åŒç±»å‹çš„å…ƒç´ </strong></p><ul><li>å¦‚æœå…ƒç´ çš„ <code>type</code> ç›¸åŒï¼ˆä¾‹å¦‚ <code>&lt;div className=&quot;old&quot;&gt;</code> â†’ <code>&lt;div className=&quot;new&quot;&gt;</code>ï¼‰ï¼ŒReact ä¼š<strong>ä¿ç•™ DOM èŠ‚ç‚¹</strong>ï¼Œä»…æ›´æ–°å˜åŒ–çš„å±æ€§ã€‚ <ul><li>å¯¹æ¯”æ–°æ—§å±æ€§ï¼Œä»…æ›´æ–°å·®å¼‚éƒ¨åˆ†ï¼ˆä¾‹å¦‚ <code>className</code>ï¼‰ã€‚</li><li>ç»„ä»¶å®ä¾‹ä¿æŒä¸å˜ï¼Œç”Ÿå‘½å‘¨æœŸæ–¹æ³•ï¼ˆå¦‚ <code>componentDidUpdate</code>ï¼‰ä¼šè¢«è§¦å‘ã€‚</li></ul></li></ul><p><strong>è§„åˆ™ä¸‰ï¼šé€’å½’å¤„ç†å­èŠ‚ç‚¹</strong></p><ul><li>å¯¹äºå­èŠ‚ç‚¹çš„å¯¹æ¯”ï¼ŒReact é»˜è®¤ä½¿ç”¨<strong>é€å±‚é€’å½’</strong>çš„æ–¹å¼ã€‚</li><li><strong>åˆ—è¡¨å¯¹æ¯”ä¼˜åŒ–</strong>ï¼š <ul><li>å½“å­å…ƒç´ æ˜¯åˆ—è¡¨ï¼ˆä¾‹å¦‚é€šè¿‡ <code>map</code> ç”Ÿæˆçš„å…ƒç´ ï¼‰æ—¶ï¼ŒReact éœ€è¦å”¯ä¸€ <code>key</code> æ¥æ ‡è¯†å…ƒç´ ï¼Œä»¥é«˜æ•ˆå¤ç”¨ DOM èŠ‚ç‚¹ã€‚</li><li>è‹¥æœªæä¾› <code>key</code>ï¼ŒReact ä¼šæŒ‰é¡ºåºå¯¹æ¯”å­èŠ‚ç‚¹ï¼Œå¯èƒ½å¯¼è‡´æ€§èƒ½ä¸‹é™æˆ–çŠ¶æ€é”™è¯¯ï¼ˆä¾‹å¦‚åˆ—è¡¨é¡ºåºå˜åŒ–æ—¶ï¼‰ã€‚</li></ul></li></ul><ol start="3"><li><strong>æ›´æ–°çœŸå® DOM</strong></li></ol><ul><li>é€šè¿‡ Diffing ç®—æ³•æ‰¾å‡ºå·®å¼‚åï¼ŒReact å°†ç”Ÿæˆä¸€ç³»åˆ—<strong>æœ€å°åŒ–çš„ DOM æ“ä½œæŒ‡ä»¤</strong>ï¼ˆä¾‹å¦‚ <code>updateTextContent</code>ã€<code>replaceChild</code>ï¼‰ã€‚</li><li>è¿™äº›æŒ‡ä»¤ä¼šè¢«æ‰¹é‡åº”ç”¨åˆ°çœŸå® DOM ä¸Šï¼Œä»¥å‡å°‘é‡ç»˜å’Œé‡æ’çš„æ¬¡æ•°ï¼Œæé«˜æ€§èƒ½ã€‚</li></ul><ol start="4"><li><strong>åè°ƒçš„ä¼˜åŒ–ç­–ç•¥</strong></li></ol><ul><li><strong>Key çš„ä½œç”¨</strong>ï¼šä¸ºåˆ—è¡¨å…ƒç´ æä¾›å”¯ä¸€çš„ <code>key</code>ï¼Œå¸®åŠ© React è¯†åˆ«å…ƒç´ çš„ç§»åŠ¨ã€æ·»åŠ æˆ–åˆ é™¤ï¼Œé¿å…ä¸å¿…è¦çš„é‡å»ºã€‚</li><li><strong>æ‰¹é‡æ›´æ–°ï¼ˆBatchingï¼‰</strong>ï¼šReact ä¼šå°†å¤šä¸ªçŠ¶æ€æ›´æ–°åˆå¹¶ä¸ºä¸€æ¬¡æ¸²æŸ“ï¼Œå‡å°‘é‡å¤è®¡ç®—ã€‚</li><li><strong>Fiber æ¶æ„</strong>ï¼ˆReact 16+ï¼‰ï¼š <ul><li>å°†åè°ƒè¿‡ç¨‹æ‹†åˆ†ä¸ºå¯ä¸­æ–­çš„â€œå·¥ä½œå•å…ƒâ€ï¼ˆFiber èŠ‚ç‚¹ï¼‰ï¼Œå…è®¸é«˜ä¼˜å…ˆçº§ä»»åŠ¡ï¼ˆå¦‚åŠ¨ç”»ï¼‰ä¼˜å…ˆå¤„ç†ã€‚</li><li>æ”¯æŒå¼‚æ­¥æ¸²æŸ“ï¼ˆConcurrent Modeï¼‰ï¼Œé¿å…é•¿æ—¶é—´é˜»å¡ä¸»çº¿ç¨‹ã€‚</li></ul></li></ul></details><h2 id="react-ç»„ä»¶æ¸²æŸ“å’Œæ›´æ–°çš„å…¨è¿‡ç¨‹" tabindex="-1">React ç»„ä»¶æ¸²æŸ“å’Œæ›´æ–°çš„å…¨è¿‡ç¨‹ <a class="header-anchor" href="#react-ç»„ä»¶æ¸²æŸ“å’Œæ›´æ–°çš„å…¨è¿‡ç¨‹" aria-label="Permalink to &quot;React ç»„ä»¶æ¸²æŸ“å’Œæ›´æ–°çš„å…¨è¿‡ç¨‹&quot;">â€‹</a></h2><p>å‚è€ƒç­”æ¡ˆ</p><details class="details custom-block"><summary>Details</summary><p>React ç»„ä»¶çš„æ¸²æŸ“å’Œæ›´æ–°è¿‡ç¨‹æ¶‰åŠå¤šä¸ªé˜¶æ®µï¼ŒåŒ…æ‹¬ <strong>åˆå§‹åŒ–ã€æ¸²æŸ“ã€åè°ƒã€æäº¤ã€æ¸…ç†</strong> ç­‰ã€‚ä»¥ä¸‹æ˜¯ React ç»„ä»¶æ¸²æŸ“å’Œæ›´æ–°çš„å…¨è¿‡ç¨‹ï¼Œç»“åˆæºç é€»è¾‘å’Œå…³é”®æ­¥éª¤è¿›è¡Œè¯¦ç»†åˆ†æã€‚</p><hr><p><strong>1. æ•´ä½“æµç¨‹æ¦‚è¿°</strong> React çš„æ¸²æŸ“å’Œæ›´æ–°è¿‡ç¨‹å¯ä»¥åˆ†ä¸ºä»¥ä¸‹å‡ ä¸ªé˜¶æ®µï¼š</p><ol><li><strong>åˆå§‹åŒ–é˜¶æ®µ</strong>ï¼šåˆ›å»º Fiber æ ‘å’Œ Hooks é“¾è¡¨ã€‚</li><li><strong>æ¸²æŸ“é˜¶æ®µ</strong>ï¼šç”Ÿæˆæ–°çš„è™šæ‹Ÿ DOMï¼ˆFiber æ ‘ï¼‰ã€‚</li><li><strong>åè°ƒé˜¶æ®µ</strong>ï¼šå¯¹æ¯”æ–°æ—§ Fiber æ ‘ï¼Œæ‰¾å‡ºéœ€è¦æ›´æ–°çš„éƒ¨åˆ†ã€‚</li><li><strong>æäº¤é˜¶æ®µ</strong>ï¼šå°†æ›´æ–°åº”ç”¨åˆ°çœŸå® DOMã€‚</li><li><strong>æ¸…ç†é˜¶æ®µ</strong>ï¼šé‡ç½®å…¨å±€å˜é‡ï¼Œå‡†å¤‡ä¸‹ä¸€æ¬¡æ›´æ–°ã€‚</li></ol><p><strong>2. è¯¦ç»†æµç¨‹åˆ†æ</strong></p><p><strong>ï¼ˆ1ï¼‰åˆå§‹åŒ–é˜¶æ®µ</strong></p><ul><li><strong>è§¦å‘æ¡ä»¶</strong>ï¼šç»„ä»¶é¦–æ¬¡æ¸²æŸ“æˆ–çŠ¶æ€/å±æ€§æ›´æ–°ã€‚</li><li><strong>å…³é”®å‡½æ•°</strong>ï¼š<code>render</code>ã€<code>createRoot</code>ã€<code>scheduleUpdateOnFiber</code>ã€‚</li><li><strong>é€»è¾‘</strong>ï¼š <ol><li>é€šè¿‡ <code>ReactDOM.render</code> æˆ– <code>createRoot</code> åˆå§‹åŒ–åº”ç”¨ã€‚</li><li>åˆ›å»ºæ ¹ Fiber èŠ‚ç‚¹ï¼ˆ<code>HostRoot</code>ï¼‰ã€‚</li><li>è°ƒç”¨ <code>scheduleUpdateOnFiber</code>ï¼Œå°†æ›´æ–°ä»»åŠ¡åŠ å…¥è°ƒåº¦é˜Ÿåˆ—ã€‚</li></ol></li></ul><p><strong>ï¼ˆ2ï¼‰æ¸²æŸ“é˜¶æ®µ</strong></p><ul><li><strong>è§¦å‘æ¡ä»¶</strong>ï¼šè°ƒåº¦å™¨å¼€å§‹æ‰§è¡Œä»»åŠ¡ã€‚</li><li><strong>å…³é”®å‡½æ•°</strong>ï¼š<code>performSyncWorkOnRoot</code>ã€<code>beginWork</code>ã€<code>renderWithHooks</code>ã€‚</li><li><strong>é€»è¾‘</strong>ï¼š <ol><li>è°ƒç”¨ <code>performSyncWorkOnRoot</code>ï¼Œå¼€å§‹æ¸²æŸ“ä»»åŠ¡ã€‚</li><li>è°ƒç”¨ <code>beginWork</code>ï¼Œé€’å½’å¤„ç† Fiber èŠ‚ç‚¹ã€‚</li><li>å¯¹äºå‡½æ•°ç»„ä»¶ï¼Œè°ƒç”¨ <code>renderWithHooks</code>ï¼Œæ‰§è¡Œç»„ä»¶å‡½æ•°å¹¶ç”Ÿæˆæ–°çš„ Hooks é“¾è¡¨ã€‚</li><li>å¯¹äºç±»ç»„ä»¶ï¼Œè°ƒç”¨ <code>instance.render</code>ï¼Œç”Ÿæˆæ–°çš„è™šæ‹Ÿ DOMã€‚</li><li>å¯¹äº Host ç»„ä»¶ï¼ˆå¦‚ <code>div</code>ï¼‰ï¼Œç”Ÿæˆå¯¹åº”çš„ DOM èŠ‚ç‚¹ã€‚</li></ol></li></ul><p><strong>ï¼ˆ3ï¼‰åè°ƒé˜¶æ®µ</strong></p><ul><li><strong>è§¦å‘æ¡ä»¶</strong>ï¼šæ–°çš„è™šæ‹Ÿ DOM ç”Ÿæˆåã€‚</li><li><strong>å…³é”®å‡½æ•°</strong>ï¼š<code>reconcileChildren</code>ã€<code>diff</code>ã€‚</li><li><strong>é€»è¾‘</strong>ï¼š <ol><li>è°ƒç”¨ <code>reconcileChildren</code>ï¼Œå¯¹æ¯”æ–°æ—§ Fiber èŠ‚ç‚¹ã€‚</li><li>æ ¹æ® <code>diff</code> ç®—æ³•ï¼Œæ‰¾å‡ºéœ€è¦æ›´æ–°çš„èŠ‚ç‚¹ã€‚</li><li>ä¸ºéœ€è¦æ›´æ–°çš„èŠ‚ç‚¹æ‰“ä¸Š <code>Placement</code>ã€<code>Update</code>ã€<code>Deletion</code> ç­‰æ ‡è®°ã€‚</li></ol></li></ul><p><strong>ï¼ˆ4ï¼‰æäº¤é˜¶æ®µ</strong></p><ul><li><strong>è§¦å‘æ¡ä»¶</strong>ï¼šåè°ƒé˜¶æ®µå®Œæˆåã€‚</li><li><strong>å…³é”®å‡½æ•°</strong>ï¼š<code>commitRoot</code>ã€<code>commitWork</code>ã€‚</li><li><strong>é€»è¾‘</strong>ï¼š <ol><li>è°ƒç”¨ <code>commitRoot</code>ï¼Œå¼€å§‹æäº¤æ›´æ–°ã€‚</li><li>è°ƒç”¨ <code>commitWork</code>ï¼Œé€’å½’å¤„ç† Fiber èŠ‚ç‚¹ã€‚</li><li>æ ¹æ®èŠ‚ç‚¹çš„æ ‡è®°ï¼Œæ‰§è¡Œ DOM æ“ä½œï¼ˆå¦‚æ’å…¥ã€æ›´æ–°ã€åˆ é™¤ï¼‰ã€‚</li><li>è°ƒç”¨ç”Ÿå‘½å‘¨æœŸé’©å­ï¼ˆå¦‚ <code>componentDidMount</code>ã€<code>componentDidUpdate</code>ï¼‰ã€‚</li></ol></li></ul><p><strong>ï¼ˆ5ï¼‰æ¸…ç†é˜¶æ®µ</strong></p><ul><li><strong>è§¦å‘æ¡ä»¶</strong>ï¼šæäº¤é˜¶æ®µå®Œæˆåã€‚</li><li><strong>å…³é”®å‡½æ•°</strong>ï¼š<code>resetHooks</code>ã€<code>resetContext</code>ã€‚</li><li><strong>é€»è¾‘</strong>ï¼š <ol><li>é‡ç½®å…¨å±€å˜é‡ï¼ˆå¦‚ <code>currentlyRenderingFiber</code>ã€<code>currentHook</code>ï¼‰ã€‚</li><li>æ¸…ç†ä¸Šä¸‹æ–‡å’Œå‰¯ä½œç”¨ã€‚</li><li>å‡†å¤‡ä¸‹ä¸€æ¬¡æ›´æ–°ã€‚</li></ol></li></ul></details><h2 id="ä¸ºä½•-hooks-ä¸èƒ½æ”¾åœ¨æ¡ä»¶æˆ–å¾ªç¯ä¹‹å†…" tabindex="-1">ä¸ºä½• Hooks ä¸èƒ½æ”¾åœ¨æ¡ä»¶æˆ–å¾ªç¯ä¹‹å†…ï¼Ÿ <a class="header-anchor" href="#ä¸ºä½•-hooks-ä¸èƒ½æ”¾åœ¨æ¡ä»¶æˆ–å¾ªç¯ä¹‹å†…" aria-label="Permalink to &quot;ä¸ºä½• Hooks ä¸èƒ½æ”¾åœ¨æ¡ä»¶æˆ–å¾ªç¯ä¹‹å†…ï¼Ÿ&quot;">â€‹</a></h2><p>å‚è€ƒç­”æ¡ˆ</p><details class="details custom-block"><summary>Details</summary><p>ä¸€ä¸ªç»„ä»¶ä¸­çš„ hook ä¼šä»¥é“¾è¡¨çš„å½¢å¼ä¸²èµ·æ¥ï¼Œ FiberNode çš„ memoizedState ä¸­ä¿å­˜äº† Hooks é“¾è¡¨ä¸­çš„ç¬¬ä¸€ä¸ª Hookã€‚</p><p>åœ¨æ›´æ–°æ—¶ï¼Œä¼šå¤ç”¨ä¹‹å‰çš„ Hookï¼Œå¦‚æœé€šè¿‡äº†æ¡ä»¶æˆ–å¾ªç¯è¯­å¥ï¼Œå¢åŠ æˆ–è€…åˆ é™¤ hooksï¼Œåœ¨å¤ç”¨ hooks è¿‡ç¨‹ä¸­ï¼Œä¼šäº§ç”Ÿå¤ç”¨ hooksçŠ¶æ€å’Œå½“å‰ hooks ä¸ä¸€è‡´çš„é—®é¢˜ã€‚</p></details><h2 id="useeffect-çš„åº•å±‚æ˜¯å¦‚ä½•å®ç°çš„-ç¾å›¢" tabindex="-1">useEffect çš„åº•å±‚æ˜¯å¦‚ä½•å®ç°çš„ï¼ˆç¾å›¢ï¼‰ <a class="header-anchor" href="#useeffect-çš„åº•å±‚æ˜¯å¦‚ä½•å®ç°çš„-ç¾å›¢" aria-label="Permalink to &quot;useEffect çš„åº•å±‚æ˜¯å¦‚ä½•å®ç°çš„ï¼ˆç¾å›¢ï¼‰&quot;">â€‹</a></h2><p>å‚è€ƒç­”æ¡ˆ</p><details class="details custom-block"><summary>Details</summary><p>useEffect æ˜¯ React ç”¨äºç®¡ç†å‰¯ä½œç”¨çš„ Hookï¼Œå®ƒåœ¨ commit é˜¶æ®µ ç»Ÿä¸€æ‰§è¡Œï¼Œç¡®ä¿å‰¯ä½œç”¨ä¸ä¼šå½±å“æ¸²æŸ“ã€‚</p><p>åœ¨ React æºç ä¸­ï¼ŒuseEffect é€šè¿‡ Fiber æœºåˆ¶ åœ¨ commit é˜¶æ®µ è¿›è¡Œå¤„ç†ï¼š</p><p><strong>(1) useEffect å­˜å‚¨åœ¨ Fiber èŠ‚ç‚¹ä¸Š</strong></p><p>React ç»„ä»¶æ˜¯é€šè¿‡ Fiber æ•°æ®ç»“æ„ ç»„ç»‡çš„ï¼Œæ¯ä¸ª useEffect éƒ½ä¼šå­˜å‚¨åœ¨ fiber.updateQueue ä¸­ã€‚</p><p><strong>(2) useEffect ä½•æ—¶æ‰§è¡Œ</strong></p><p>React ç»„ä»¶æ›´æ–°åï¼ŒReact åœ¨ commit é˜¶æ®µ ç»Ÿä¸€éå† effect é˜Ÿåˆ—ï¼Œå¹¶æ‰§è¡Œ useEffect å‰¯ä½œç”¨ã€‚</p><p>React ä½¿ç”¨ <code>useEffectEvent()</code> æ³¨å†Œ effectï¼Œåœ¨ commitLayoutEffect ä¹‹åï¼Œå¼‚æ­¥æ‰§è¡Œ useEffectï¼Œé¿å…é˜»å¡ UI æ¸²æŸ“ã€‚</p><p><strong>(3) useEffect ä¾èµ–å˜åŒ–çš„å¤„ç†</strong></p><p>ä¾èµ–æ•°ç»„çš„æ¯”è¾ƒä½¿ç”¨ <code>Object.is()</code>ï¼Œåªæœ‰ä¾èµ–å˜åŒ–æ—¶æ‰é‡æ–°æ‰§è¡Œ useEffectã€‚</p><p>åœ¨æ›´æ–°é˜¶æ®µï¼ŒReact éå†æ—§ effectï¼Œå¹¶å…ˆæ‰§è¡Œæ¸…ç†å‡½æ•°ï¼Œç„¶åå†æ‰§è¡Œæ–°çš„ effectã€‚</p><p><strong>ç®€åŒ–çš„ useEffect å®ç°å¦‚ä¸‹ï¼š</strong></p><div class="language-js vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> useEffect</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">callback</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">dependencies</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> currentEffect</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> getCurrentEffect</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">() </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// è·å–å½“å‰ Fiber èŠ‚ç‚¹çš„ Effect</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">dependenciesChanged</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(currentEffect.dependencies, dependencies)) {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    cleanupPreviousEffect</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(currentEffect) </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// å…ˆæ‰§è¡Œä¸Šæ¬¡ effect çš„æ¸…ç†å‡½æ•°</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> cleanup</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> callback</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">() </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// æ‰§è¡Œ useEffect ä¼ å…¥çš„å›è°ƒ</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    currentEffect.dependencies </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> dependencies</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    currentEffect.cleanup </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> cleanup </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// å­˜å‚¨æ¸…ç†å‡½æ•°</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><p>ç›¸æ¯” useLayoutEffectï¼ŒuseEffect æ˜¯ å¼‚æ­¥æ‰§è¡Œï¼Œä¸ä¼šé˜»å¡ UI æ¸²æŸ“ã€‚</p></details></div></div></main><footer class="VPDocFooter" data-v-e6f2a212 data-v-1bcd8184><!--[--><!--]--><!----><nav class="prev-next" aria-labelledby="doc-footer-aria-label" data-v-1bcd8184><span class="visually-hidden" id="doc-footer-aria-label" data-v-1bcd8184>Pager</span><div class="pager" data-v-1bcd8184><a class="VPLink link pager-link prev" href="/mianshi/docs/second-exam/react-usage.html" data-v-1bcd8184><!--[--><span class="desc" data-v-1bcd8184>Previous page</span><span class="title" data-v-1bcd8184>React ä½¿ç”¨</span><!--]--></a></div><div class="pager" data-v-1bcd8184><a class="VPLink link pager-link next" href="/mianshi/docs/second-exam/mini-program.html" data-v-1bcd8184><!--[--><span class="desc" data-v-1bcd8184>Next page</span><span class="title" data-v-1bcd8184>å°ç¨‹åº</span><!--]--></a></div></nav></footer><!--[--><!--]--></div></div></div><!--[--><!--]--></div></div><footer class="VPFooter has-sidebar" data-v-d8b57b2d data-v-566314d4><div class="container" data-v-566314d4><p class="message" data-v-566314d4><a href="https://www.wangeditor.com/" target="_blank">wangEditor</a> | <a href="https://www.huashuiai.com/" target="_blank">åˆ’æ°´AI</a> | <a href="https://github.com/mianshipai/mianshipai-web/issues" target="_blank">æäº¤é—®é¢˜å’Œå»ºè®®</a></p><p class="copyright" data-v-566314d4>Copyright Â© 2025-present Mianshipai é¢è¯•æ´¾</p></div></footer><!--[--><!--]--></div></div>
    <script>window.__VP_HASH_MAP__=JSON.parse("{\"docs_api-examples.md\":\"CbBCwYff\",\"docs_before-interview_jd.md\":\"JjXPSTig\",\"docs_before-interview_post-resume.md\":\"N1ORZKtY\",\"docs_before-interview_process.md\":\"ClDuroLf\",\"docs_before-interview_write-resume.md\":\"B7f8950f\",\"docs_first-exam_computerbase.md\":\"CFP_fwLc\",\"docs_first-exam_html-css.md\":\"2YZ_vM4a\",\"docs_first-exam_http.md\":\"BhXG3GSH\",\"docs_first-exam_js.md\":\"DVVBo0d1\",\"docs_first-exam_ts.md\":\"CTPNKixn\",\"docs_hr-exam_behavioural-test.md\":\"Cgo3ajxS\",\"docs_hr-exam_salary.md\":\"Dl-c2lIu\",\"docs_markdown-examples.md\":\"CbnQUDGs\",\"docs_second-exam_engineering.md\":\"BbCJXkDU\",\"docs_second-exam_harmonyos-application-development.md\":\"BLRNbMYF\",\"docs_second-exam_mini-program.md\":\"BShHunQy\",\"docs_second-exam_nodejs.md\":\"BAstcvy6\",\"docs_second-exam_react-inner.md\":\"DMnU0yeD\",\"docs_second-exam_react-usage.md\":\"BZ4N_fK_\",\"docs_second-exam_vue-inner.md\":\"CV2Ezh75\",\"docs_second-exam_vue-usage.md\":\"BpsTBe6A\",\"docs_services_1v1.md\":\"DsdsJ3A1\",\"docs_services_group.md\":\"Dg-481AC\",\"docs_third-exam_ask-in-reply.md\":\"DdqCL-XK\",\"docs_third-exam_cross-test.md\":\"BwdlCMxp\",\"docs_third-exam_leader-test.md\":\"B5WS8Qlj\",\"docs_third-exam_project.md\":\"qZHwZ0m3\",\"docs_third-exam_system-design.md\":\"B2gdR2QA\",\"docs_written-exam_algorithm.md\":\"wKZNBXTX\",\"docs_written-exam_js-reading.md\":\"CuAzwbNF\",\"docs_written-exam_js-writing.md\":\"DdcBlQUx\",\"index.md\":\"DJoDmDOg\",\"readme.en.md\":\"CJK-H64S\",\"readme.md\":\"60kbotTR\"}");window.__VP_SITE_DATA__=JSON.parse("{\"lang\":\"zh-CN\",\"dir\":\"ltr\",\"title\":\"å‰ç«¯é¢è¯•æ´¾\",\"description\":\"ç³»ç»Ÿä¸“ä¸šçš„å‰ç«¯é¢è¯•å¯¼èˆªï¼Œå¤§å‚é¢è¯•è§„èŒƒï¼Œå¼€æºå…è´¹\",\"base\":\"/mianshi/\",\"head\":[],\"router\":{\"prefetchLinks\":true},\"appearance\":true,\"themeConfig\":{\"nav\":[{\"text\":\"1v1 é¢è¯•å’¨è¯¢ ğŸ”¥\",\"link\":\"/docs/services/1v1.md\"},{\"text\":\"åŠ ç¾¤è®¨è®ºç­”ç–‘\",\"link\":\"/docs/services/group.md\"},{\"text\":\"æˆä¸ºè´¡çŒ®è€…\",\"link\":\"https://github.com/mianshipai/mianshipai-web#%E8%B4%A1%E7%8C%AE%E9%A2%98%E7%9B%AE%E5%92%8C%E7%AD%94%E6%A1%88\"}],\"search\":{\"provider\":\"local\"},\"outline\":{\"level\":[2,3],\"label\":\"ç›®å½•\"},\"sidebar\":[{\"text\":\"é¢è¯•å‡†å¤‡\",\"items\":[{\"text\":\"äº†è§£é¢è¯•æµç¨‹\",\"link\":\"/docs/before-interview/process.md\"},{\"text\":\"åˆ†æ JD æ‹›è˜è¦æ±‚\",\"link\":\"/docs/before-interview/jd.md\"},{\"text\":\"æ­£ç¡®å†™ç®€å†\",\"link\":\"/docs/before-interview/write-resume.md\"},{\"text\":\"å¦‚ä½•æŠ•é€’ç®€å†\",\"link\":\"/docs/before-interview/post-resume.md\"}]},{\"text\":\"ç¬”è¯•\",\"items\":[{\"text\":\"æ•°æ®ç»“æ„å’Œç®—æ³•\",\"link\":\"/docs/written-exam/algorithm\"},{\"text\":\"JS æ‰‹å†™ä»£ç \",\"link\":\"/docs/written-exam/JS-writing\"},{\"text\":\"JS è¯»ä»£ç \",\"link\":\"/docs/written-exam/JS-reading\"}]},{\"text\":\"ä¸€é¢\",\"items\":[{\"text\":\"è®¡ç®—æœºåŸºç¡€\",\"link\":\"/docs/first-exam/ComputerBase.md\"},{\"text\":\"HTML å’Œ CSS\",\"link\":\"/docs/first-exam/HTML-CSS.md\"},{\"text\":\"JS åŸºç¡€çŸ¥è¯†\",\"link\":\"/docs/first-exam/JS\"},{\"text\":\"TS ç±»å‹\",\"link\":\"/docs/first-exam/TS\"},{\"text\":\"HTTP ç½‘ç»œè¯·æ±‚\",\"link\":\"/docs/first-exam/HTTP.md\"}]},{\"text\":\"äºŒé¢\",\"items\":[{\"text\":\"Vue ä½¿ç”¨\",\"link\":\"/docs/second-exam/vue-usage.md\"},{\"text\":\"Vue åŸç†\",\"link\":\"/docs/second-exam/vue-inner.md\"},{\"text\":\"React ä½¿ç”¨\",\"link\":\"/docs/second-exam/react-usage.md\"},{\"text\":\"React åŸç†\",\"link\":\"/docs/second-exam/react-inner.md\"},{\"text\":\"å°ç¨‹åº\",\"link\":\"/docs/second-exam/mini-program.md\"},{\"text\":\"å‰ç«¯å·¥ç¨‹åŒ–\",\"link\":\"/docs/second-exam/engineering.md\"},{\"text\":\"é¸¿è’™åº”ç”¨å¼€å‘\",\"link\":\"/docs/second-exam/HarmonyOS-application-development.md\"},{\"text\":\"Nodejs\",\"link\":\"/docs/second-exam/nodejs.md\"}]},{\"text\":\"ä¸‰é¢\",\"items\":[{\"text\":\"äº¤å‰é¢è¯•\",\"link\":\"/docs/third-exam/cross-test.md\"},{\"text\":\"é¡¹ç›®éš¾ç‚¹/æˆç»©\",\"link\":\"/docs/third-exam/project.md\"},{\"text\":\"å‰ç«¯ Leader é¢è¯•\",\"link\":\"/docs/third-exam/leader-test.md\"},{\"text\":\"åé—®é¢è¯•å®˜\",\"link\":\"/docs/third-exam/ask-in-reply.md\"}]},{\"text\":\"HR é¢\",\"items\":[{\"text\":\"è¡Œä¸ºé¢è¯•\",\"link\":\"/docs/hr-exam/behavioural-test.md\"},{\"text\":\"è°ˆè–ªæŠ€å·§\",\"link\":\"/docs/hr-exam/salary.md\"}]},{\"text\":\"æœåŠ¡\",\"items\":[{\"text\":\"åŠ ç¾¤è®¨è®ºç­”ç–‘\",\"link\":\"/docs/services/group.md\"},{\"text\":\"æˆä¸ºè´¡çŒ®è€…\",\"link\":\"https://github.com/mianshipai/mianshipai-web#%E8%B4%A1%E7%8C%AE%E9%A2%98%E7%9B%AE%E5%92%8C%E7%AD%94%E6%A1%88\"},{\"text\":\"1v1 é¢è¯•å’¨è¯¢ ğŸ”¥\",\"link\":\"/docs/services/1v1.md\"}]}],\"socialLinks\":[{\"icon\":\"github\",\"link\":\"https://github.com/mianshipai/mianshipai-web\"}],\"footer\":{\"message\":\"<a href=\\\"https://www.wangeditor.com/\\\" target=\\\"_blank\\\">wangEditor</a> | <a href=\\\"https://www.huashuiai.com/\\\" target=\\\"_blank\\\">åˆ’æ°´AI</a> | <a href=\\\"https://github.com/mianshipai/mianshipai-web/issues\\\" target=\\\"_blank\\\">æäº¤é—®é¢˜å’Œå»ºè®®</a>\",\"copyright\":\"Copyright Â© 2025-present Mianshipai é¢è¯•æ´¾\"}},\"locales\":{},\"scrollOffset\":134,\"cleanUrls\":false}");</script>
    
  </body>
</html>